import{s as O,p as z}from"./index-DfY7MOwJ.js";import{h as N,i as m,o as x,q as j,b as G,_ as J}from"./main-Dirrnzcr.js";import{_ as Q}from"./ViewList.vue_vue_type_style_index_0_lang-qcv9jr1D.js";import{V as f}from"./ViewContent.vue_vue_type_script_setup_true_lang-Dpo1Y2zC.js";import{_ as H}from"./ImageUpload.vue_vue_type_script_setup_true_lang-BZyBfOer.js";import"./Common-dWa9BEsb.js";import"./IndustryUtil-CgRifmxX.js";import"./TableViewContent.vue_vue_type_script_setup_true_lang-5zjbO-p-.js";import"./TableColumnViewContent.vue_vue_type_script_setup_true_lang-s5dcpuXa.js";const W={class:"query-container"},X={class:"query-btn"},Z=Vue.createTextVNode("Search"),ee=Vue.createTextVNode("Add "),le={class:"dialog-footer"},ae=Vue.createTextVNode("Cancel"),te=Vue.createTextVNode("Confirm"),ue=Vue.defineComponent({__name:"Index",setup(re){const a=Vuex.useStore(),_=a.state.user,i=a.state.roleCodeList,S=Vue.ref(null),I=Vue.ref([]),L=Vue.ref([]),E=(u,l,r,s="yyyy-MM-dd hh:mm:ss")=>{r=r||"createDate";const p=r.charAt(0).toUpperCase()+r.slice(1),k=`start${p}`,b=`end${p}`;u&&u.length>1?(l[k]=x(u[0],s),l[b]=x(u[1],s)):(l[k]="",l[b]=""),V()},v=Vue.ref([{value:"expand",label:"",width:48,type:f.Expand},{value:"index",labelKey:"index",width:80},{value:"operator",labelKey:"viewAndEdit",width:180,type:f.Operator},{value:"createTime",labelKey:"createTime",width:91},{value:"username",labelKey:"username",width:152},{value:"departmentFormat",labelKey:"department",width:168},{value:"name",labelKey:"chineseName",width:168},{value:"userPropertyFormat",labelKey:"userProperty",width:168},{value:"leaderUserIdFormat",originValue:"leaderUserId",labelKey:"leaderUserId",width:139},{value:"professionFormat",labelKey:"profession",width:289},{value:"mobile",labelKey:"mobile",width:128},{value:"roleNameList",labelKey:"role",width:256,type:f.TagList},{value:"interviewResume",labelKey:"interviewResume",width:368,type:f.Text,showOverflow:!0},{value:"photoList",labelKey:"photo",width:269,type:f.Image},{value:"stateFormat",labelKey:"state",width:72}]),P={userId:"",lastIncreaseSalaryDate:"",planIncreaseSalaryDate:"",photoList:[],roleIdList:["user"],username:"",profession:"",leaderUserId:"",mobile:"",department:"",name:"",interviewResume:"",password:"123456",state:0,userProperty:"",schedule:""},n=Vue.reactive({query:{data:{startPlanIncreaseSalaryDate:"",endPlanIncreaseSalaryDate:"",startCreateTime:"",endCreateTime:"",department:"",profession:"",username:"",roleId:"",name:"",userProperty:"",schedule:"",leaderUserId:"",state:0}},config:{processProcedureList:[],testDeviceList:[],customerShortNameList:[],departmentList:[],professionList:[],optimizeTypeList:[],userPropertyList:[],scheduleList:[]},formData:Object.assign({},P),formRuleList:{roleIdList:[{required:!0,message:"Please check",trigger:"blur"}],username:[{required:!0,message:"Please check",trigger:"blur"}],mail:[{required:!0,message:"Please check",trigger:"blur"}],mobile:[{required:!0,message:"Please check",trigger:"blur"}],nickname:[{required:!0,message:"Please check",trigger:"blur"}],name:[{required:!0,message:"Please check",trigger:"blur"}],photoList:[{required:!1,type:"array",min:0,max:5}]},tableData:new Array,formSave:!1,formVisible:!1}),V=()=>{N("system/user/list",n.query.data).then(u=>{n.tableData=(u.list||[]).map(l=>(l.roleNameList=(l.roleList||[]).map(r=>r.roleName),l)),ElementPlus.ElMessage.success("Query success")})},B=Vue.ref(new Array);N("system/role/group/list",{}).then(u=>{B.value=u.list});const T=()=>{n.formVisible=!0,n.formSave=!0,n.formData=Object.assign({},P)},F=(u,l=0)=>{n.formVisible=!0,n.formSave=!1,n.formData=Object.assign({},u)},$=({row:u,rowIndex:l})=>u.planIncreaseSalaryDateCount!=null&&u.planIncreaseSalaryDateCount<30?"row-yellow":"",Y=()=>{S.value.validate(u=>{u&&(n.formSave?j("system/user",n.formData).then(()=>{n.formVisible=!1,ElementPlus.ElMessage.success("Add success"),V()}):K(n.formData))})},K=u=>G("system/user",u).then(()=>{n.formVisible=!1,ElementPlus.ElMessage.success("Edit success"),V()}),w=Vue.ref(new Array),D=_.username==="admin"||m(i,"userManager");Promise.all([N("douson/config",{categoryIdList:["processProcedure","testDevice","customerShortName","department","profession","optimizeType","userProperty","schedule"]}),N("system/user/config/list",{})]).then(u=>{n.config=u[0].data,w.value=(u[1].list||[]).map(l=>({value:l.userId,label:l.name})),m(i,"admin")&&(v.value=v.value.map(l=>(l.value==="schedule"?(l.type=f.SelectEdit,l.optionList=n.config.scheduleList):l.value==="leaderUserIdFormat"&&(l.type=f.SelectEdit,l.optionList=w.value),l))),m(i,"userManager")||(v.value=v.value.filter(l=>l.value!=="interviewResume")),D&&v.value.push({value:"lastIncreaseSalaryDate",labelKey:"lastIncreaseSalaryDate",width:101,type:f.DateEdit},{value:"planIncreaseSalaryDate",labelKey:"planIncreaseSalaryDate",width:101,type:f.DateEdit}),V()});const{query:o,tableData:R,formData:t,formSave:M,config:h,formVisible:C,formRuleList:U}={...Vue.toRefs(n)};return(u,l)=>{const r=Vue.resolveComponent("el-option"),s=Vue.resolveComponent("el-select"),p=Vue.resolveComponent("el-input"),k=Vue.resolveComponent("el-option-group"),b=Vue.resolveComponent("el-date-picker"),g=Vue.resolveComponent("el-button"),d=Vue.resolveComponent("el-form-item"),q=Vue.resolveComponent("el-form"),A=Vue.resolveComponent("el-dialog");return Vue.openBlock(),Vue.createElementBlock("div",null,[Vue.createElementVNode("div",W,[Vue.createVNode(s,{modelValue:Vue.unref(o).data.department,"onUpdate:modelValue":l[0]||(l[0]=e=>Vue.unref(o).data.department=e),filterable:"","allow-create":"",clearable:"",placeholder:Vue.unref(a).state.label.department,onChange:V},{default:Vue.withCtx(()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(h).departmentList,e=>(Vue.openBlock(),Vue.createBlock(r,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"]),Vue.createVNode(s,{modelValue:Vue.unref(o).data.profession,"onUpdate:modelValue":l[1]||(l[1]=e=>Vue.unref(o).data.profession=e),filterable:"","allow-create":"",clearable:"",placeholder:Vue.unref(a).state.label.profession,onChange:V},{default:Vue.withCtx(()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(h).professionList,e=>(Vue.openBlock(),Vue.createBlock(r,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"]),Vue.createVNode(p,{modelValue:Vue.unref(o).data.username,"onUpdate:modelValue":l[2]||(l[2]=e=>Vue.unref(o).data.username=e),onKeyup:Vue.withKeys(V,["enter"]),placeholder:Vue.unref(a).state.label.username},null,8,["modelValue","onKeyup","placeholder"]),Vue.createVNode(p,{modelValue:Vue.unref(o).data.name,"onUpdate:modelValue":l[3]||(l[3]=e=>Vue.unref(o).data.name=e),onKeyup:Vue.withKeys(V,["enter"]),placeholder:Vue.unref(a).state.label.chineseName},null,8,["modelValue","onKeyup","placeholder"]),Vue.createVNode(s,{modelValue:Vue.unref(o).data.roleId,"onUpdate:modelValue":l[4]||(l[4]=e=>Vue.unref(o).data.roleId=e),onChange:V,clearable:"",placeholder:Vue.unref(a).state.label.role},{default:Vue.withCtx(()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(B.value,(e,c)=>(Vue.openBlock(),Vue.createBlock(k,{key:`group-${c}`,label:e.label},{default:Vue.withCtx(()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(e.list||[],y=>(Vue.openBlock(),Vue.createBlock(r,{key:y.roleId,label:y.roleName,value:y.roleId},null,8,["label","value"]))),128))]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue","placeholder"]),Vue.unref(m)(Vue.unref(i),"admin")?(Vue.openBlock(),Vue.createBlock(s,{key:0,modelValue:Vue.unref(o).data.state,"onUpdate:modelValue":l[5]||(l[5]=e=>Vue.unref(o).data.state=e),onChange:V,clearable:"",placeholder:Vue.unref(a).state.label.state},{default:Vue.withCtx(()=>[Vue.createVNode(r,{label:Vue.unref(a).state.label.normal,value:0},null,8,["label"]),Vue.createVNode(r,{label:Vue.unref(a).state.label.leaveCompany,value:1},null,8,["label"])]),_:1},8,["modelValue","placeholder"])):Vue.createCommentVNode("",!0),Vue.createVNode(s,{modelValue:Vue.unref(o).data.userProperty,"onUpdate:modelValue":l[6]||(l[6]=e=>Vue.unref(o).data.userProperty=e),onChange:V,clearable:"",placeholder:Vue.unref(a).state.label.userProperty},{default:Vue.withCtx(()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(h).userPropertyList,e=>(Vue.openBlock(),Vue.createBlock(r,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"]),Vue.createVNode(s,{modelValue:Vue.unref(o).data.leaderUserId,"onUpdate:modelValue":l[7]||(l[7]=e=>Vue.unref(o).data.leaderUserId=e),onChange:V,filterable:"","allow-create":"",clearable:"",placeholder:Vue.unref(a).state.label.leaderUserId,class:"search-item"},{default:Vue.withCtx(()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(w.value,e=>(Vue.openBlock(),Vue.createBlock(r,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"]),Vue.createVNode(b,{modelValue:I.value,"onUpdate:modelValue":l[8]||(l[8]=e=>I.value=e),onChange:l[9]||(l[9]=()=>{E(I.value,Vue.unref(o).data,"createTime")}),type:"daterange",format:"YYYY-MM-DD","range-separator":"-","start-placeholder":`Start ${Vue.unref(a).state.label.createTime}`,"end-placeholder":`End ${Vue.unref(a).state.label.createTime}`,style:{width:"180px","margin-right":"20px"}},null,8,["modelValue","start-placeholder","end-placeholder"]),Vue.createVNode(b,{modelValue:L.value,"onUpdate:modelValue":l[10]||(l[10]=e=>L.value=e),onChange:l[11]||(l[11]=()=>{E(L.value,Vue.unref(o).data,"planIncreaseSalaryDate")}),type:"daterange",format:"YYYY-MM-DD","range-separator":"-","start-placeholder":`Start ${Vue.unref(a).state.label.planIncreaseSalaryDate}`,"end-placeholder":`End ${Vue.unref(a).state.label.planIncreaseSalaryDate}`,style:{width:"180px","margin-right":"20px"}},null,8,["modelValue","start-placeholder","end-placeholder"]),Vue.createElementVNode("div",X,[Vue.createVNode(g,{icon:Vue.unref(O),onClick:V,type:"primary"},{default:Vue.withCtx(()=>[Z]),_:1},8,["icon"]),Vue.unref(m)(Vue.unref(i),"admin")?(Vue.openBlock(),Vue.createBlock(g,{key:0,icon:Vue.unref(z),onClick:T,type:"success"},{default:Vue.withCtx(()=>[ee]),_:1},8,["icon"])):Vue.createCommentVNode("",!0)])]),Vue.createVNode(Q,{idKey:"userId",columnConfigList:v.value,list:Vue.unref(R),handleTableRowClassName:$,handleEdit:Vue.unref(m)(Vue.unref(i),"admin")?F:null,"handle-update":Vue.unref(m)(Vue.unref(i),"admin")?K:null},null,8,["columnConfigList","list","handleEdit","handle-update"]),Vue.createVNode(A,{title:Vue.unref(M)?"Add":"Edit",modelValue:Vue.unref(C),"onUpdate:modelValue":l[29]||(l[29]=e=>Vue.isRef(C)?C.value=e:null),width:"60%"},{footer:Vue.withCtx(()=>[Vue.createElementVNode("span",le,[Vue.createVNode(g,{onClick:l[28]||(l[28]=e=>C.value=!1)},{default:Vue.withCtx(()=>[ae]),_:1}),Vue.createVNode(g,{type:"primary",onClick:Y},{default:Vue.withCtx(()=>[te]),_:1})])]),default:Vue.withCtx(()=>[Vue.createVNode(q,{rules:Vue.unref(U),model:Vue.unref(t),ref_key:"formRef",ref:S,"label-width":"128px"},{default:Vue.withCtx(()=>[Vue.createVNode(d,{prop:"userId",label:"User id"},{default:Vue.withCtx(()=>[Vue.createVNode(p,{modelValue:Vue.unref(t).userId,"onUpdate:modelValue":l[12]||(l[12]=e=>Vue.unref(t).userId=e),disabled:!Vue.unref(M),placeholder:"User ID, if empty, auto create"},null,8,["modelValue","disabled"])]),_:1}),Vue.createVNode(d,{prop:"username",label:Vue.unref(a).state.label.username},{default:Vue.withCtx(()=>[Vue.createVNode(p,{modelValue:Vue.unref(t).username,"onUpdate:modelValue":l[13]||(l[13]=e=>Vue.unref(t).username=e)},null,8,["modelValue"])]),_:1},8,["label"]),Vue.createVNode(d,{prop:"leaderUserId",label:Vue.unref(a).state.label.leaderUserId},{default:Vue.withCtx(()=>[Vue.createVNode(s,{modelValue:Vue.unref(t).leaderUserId,"onUpdate:modelValue":l[14]||(l[14]=e=>Vue.unref(t).leaderUserId=e),clearable:"",filterable:"",placeholder:"Please select"},{default:Vue.withCtx(()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(w.value,e=>(Vue.openBlock(),Vue.createBlock(r,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),Vue.createVNode(d,{prop:"department",label:Vue.unref(a).state.label.department},{default:Vue.withCtx(()=>[Vue.createVNode(s,{modelValue:Vue.unref(t).department,"onUpdate:modelValue":l[15]||(l[15]=e=>Vue.unref(t).department=e),filterable:"","allow-create":"",clearable:"",placeholder:Vue.unref(a).state.label.department,disabled:!Vue.unref(m)(Vue.unref(i),"admin")},{default:Vue.withCtx(()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(h).departmentList,e=>(Vue.openBlock(),Vue.createBlock(r,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder","disabled"])]),_:1},8,["label"]),Vue.createVNode(d,{prop:"name",label:Vue.unref(a).state.label.chineseName},{default:Vue.withCtx(()=>[Vue.createVNode(p,{modelValue:Vue.unref(t).name,"onUpdate:modelValue":l[16]||(l[16]=e=>Vue.unref(t).name=e)},null,8,["modelValue"])]),_:1},8,["label"]),Vue.createVNode(d,{prop:"userProperty",label:Vue.unref(a).state.label.userProperty},{default:Vue.withCtx(()=>[Vue.createVNode(s,{modelValue:Vue.unref(t).userProperty,"onUpdate:modelValue":l[17]||(l[17]=e=>Vue.unref(t).userProperty=e),clearable:"",placeholder:Vue.unref(a).state.label.userProperty},{default:Vue.withCtx(()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(h).userPropertyList,e=>(Vue.openBlock(),Vue.createBlock(r,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),Vue.createVNode(d,{prop:"profession",label:Vue.unref(a).state.label.profession},{default:Vue.withCtx(()=>[Vue.createVNode(s,{modelValue:Vue.unref(t).profession,"onUpdate:modelValue":l[18]||(l[18]=e=>Vue.unref(t).profession=e),filterable:"","allow-create":"",clearable:"",placeholder:Vue.unref(a).state.label.profession,disabled:!Vue.unref(m)(Vue.unref(i),"admin")},{default:Vue.withCtx(()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(h).professionList,e=>(Vue.openBlock(),Vue.createBlock(r,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder","disabled"])]),_:1},8,["label"]),Vue.createVNode(d,{prop:"mobile",label:Vue.unref(a).state.label.mobile},{default:Vue.withCtx(()=>[Vue.createVNode(p,{modelValue:Vue.unref(t).mobile,"onUpdate:modelValue":l[19]||(l[19]=e=>Vue.unref(t).mobile=e)},null,8,["modelValue"])]),_:1},8,["label"]),Vue.createVNode(d,{prop:"roleIdList",label:Vue.unref(a).state.label.role},{default:Vue.withCtx(()=>[Vue.createVNode(s,{modelValue:Vue.unref(t).roleIdList,"onUpdate:modelValue":l[20]||(l[20]=e=>Vue.unref(t).roleIdList=e),disabled:Vue.unref(_).username!=="admin",multiple:"",clearable:"",placeholder:Vue.unref(a).state.label.role},{default:Vue.withCtx(()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(B.value,(e,c)=>(Vue.openBlock(),Vue.createBlock(k,{key:`group-${c}`,label:e.label},{default:Vue.withCtx(()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(e.list||[],y=>(Vue.openBlock(),Vue.createBlock(r,{key:y.roleId,label:y.roleName,value:y.roleId},null,8,["label","value"]))),128))]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue","disabled","placeholder"])]),_:1},8,["label"]),Vue.unref(m)(Vue.unref(i),"userManager")?(Vue.openBlock(),Vue.createBlock(d,{key:0,prop:"interviewResume",label:Vue.unref(a).state.label.interviewResume},{default:Vue.withCtx(()=>[Vue.createVNode(p,{type:"textarea",rows:4,modelValue:Vue.unref(t).interviewResume,"onUpdate:modelValue":l[21]||(l[21]=e=>Vue.unref(t).interviewResume=e)},null,8,["modelValue"])]),_:1},8,["label"])):Vue.createCommentVNode("",!0),Vue.createVNode(d,{prop:"password",label:Vue.unref(a).state.label.password},{default:Vue.withCtx(()=>[Vue.createVNode(p,{modelValue:Vue.unref(t).password,"onUpdate:modelValue":l[22]||(l[22]=e=>Vue.unref(t).password=e)},null,8,["modelValue"])]),_:1},8,["label"]),Vue.createVNode(d,{prop:"photoList",label:`${Vue.unref(a).state.label.portrait}(${(Vue.unref(U).photoList||[]).reduce((e,c)=>`Min: ${c.min}, Max: ${c.max}`,"Unlimited")})`},{default:Vue.withCtx(()=>[Vue.createVNode(H,{photoList:Vue.unref(t).photoList,maxSize:+`${(Vue.unref(U).photoList||[]).reduce((e,c)=>c.max,999)}`},null,8,["photoList","maxSize"])]),_:1},8,["label"]),Vue.createVNode(d,{prop:"state",label:Vue.unref(a).state.label.state},{default:Vue.withCtx(()=>[Vue.createVNode(s,{modelValue:Vue.unref(t).state,"onUpdate:modelValue":l[23]||(l[23]=e=>Vue.unref(t).state=e),filterable:"","allow-create":"",clearable:"",placeholder:Vue.unref(a).state.label.state,disabled:!Vue.unref(m)(Vue.unref(i),"admin")},{default:Vue.withCtx(()=>[Vue.createVNode(r,{value:0,label:"Normal"}),Vue.createVNode(r,{value:1,label:"Leave"})]),_:1},8,["modelValue","placeholder","disabled"])]),_:1},8,["label"]),Vue.unref(D)?(Vue.openBlock(),Vue.createBlock(d,{key:1,prop:"lastIncreaseSalaryDate",label:Vue.unref(a).state.label.lastIncreaseSalaryDate},{default:Vue.withCtx(()=>[Vue.createVNode(b,{type:"date",modelValue:Vue.unref(t).lastIncreaseSalaryDate,"onUpdate:modelValue":l[24]||(l[24]=e=>Vue.unref(t).lastIncreaseSalaryDate=e),format:"YYYY-MM-DD",onChange:l[25]||(l[25]=e=>Vue.unref(t).lastIncreaseSalaryDate=Vue.unref(x)(Vue.unref(t).lastIncreaseSalaryDate,"yyyy-MM-dd"))},null,8,["modelValue"])]),_:1},8,["label"])):Vue.createCommentVNode("",!0),Vue.unref(D)?(Vue.openBlock(),Vue.createBlock(d,{key:2,prop:"planIncreaseSalaryDate",label:Vue.unref(a).state.label.planIncreaseSalaryDate},{default:Vue.withCtx(()=>[Vue.createVNode(b,{type:"date",modelValue:Vue.unref(t).date,"onUpdate:modelValue":l[26]||(l[26]=e=>Vue.unref(t).date=e),format:"YYYY-MM-DD",onChange:l[27]||(l[27]=e=>Vue.unref(t).planIncreaseSalaryDate=Vue.unref(x)(Vue.unref(t).planIncreaseSalaryDate,"yyyy-MM-dd"))},null,8,["modelValue"])]),_:1},8,["label"])):Vue.createCommentVNode("",!0)]),_:1},8,["rules","model"])]),_:1},8,["title","modelValue"])])}}}),ce=J(ue,[["__scopeId","data-v-7eaf23e2"]]);export{ce as default};
