import{s as T,p as M,e as U}from"./index-DfY7MOwJ.js";import{i as b,h as R,q as L,b as A}from"./main-Dirrnzcr.js";import{D as B,a as H}from"./Common-dWa9BEsb.js";const I={class:"query-container"},$={class:"query-btn"},F=Vue.createTextVNode("Search"),K=Vue.createTextVNode("Add "),j=Vue.createTextVNode(" Edit "),G=Vue.createTextVNode(" : "),J={class:"dialog-footer"},O=Vue.createTextVNode("Cancel"),z=Vue.createTextVNode("Confirm"),ee=Vue.defineComponent({__name:"Device",setup(Q){const V=Vuex.useStore(),m=V.state.roleCodeList;VueRouter.useRouter();const g=VueRouter.useRoute(),p=Vue.ref(null),o=Vue.reactive({query:{data:{deviceId:"",deviceName:""},page:{page:H,limit:B}},tableData:new Array,formData:{id:"",deviceName:"",unitPrice:0,runningHour:0,runningMinute:0,supplier:!1,sorter:0},formSave:!1,formVisible:!1,formRuleList:{deviceName:[{required:!0,message:"请输入",trigger:"blur"}],unitPrice:[{required:!0,message:"请输入",trigger:"blur"}],runningHour:[{required:!0,message:"请输入",trigger:"blur"}],runningMinute:[{required:!0,message:"请输入",trigger:"blur"}],supplier:[{required:!0,message:"Please select",trigger:"blur"}]}}),a=(l="")=>{o.query.data.deviceId=l,R("douson/admin/device/list",o.query.data).then(t=>{const n=t.list||[];o.tableData=n,l&&n.length>0&&(o.formVisible=!0,o.formData=Object.assign({},n[0])),ElementPlus.ElMessage.success("Query success")})},N=String(g.query.deviceId||"");a(N);const v=()=>{o.formVisible=!0,o.formSave=!0},h=(l,t=0)=>{o.formVisible=!0,o.formSave=!1,o.formData=Object.assign({},l)},x=()=>{p.value.validate(l=>{l&&(o.formSave?L("douson/admin/device",o.formData).then(()=>{o.formVisible=!1,ElementPlus.ElMessage.success("Add success"),a()}):A("douson/admin/device",o.formData).then(()=>{o.formVisible=!1,ElementPlus.ElMessage.success("Update success"),a()}))})},{query:f,tableData:C,formData:u,formSave:w,formVisible:s,formRuleList:y}={...Vue.toRefs(o)};return(l,t)=>{const n=Vue.resolveComponent("el-input"),d=Vue.resolveComponent("el-button"),r=Vue.resolveComponent("el-table-column"),k=Vue.resolveComponent("el-link"),E=Vue.resolveComponent("el-space"),D=Vue.resolveComponent("el-table"),i=Vue.resolveComponent("el-form-item"),c=Vue.resolveComponent("el-input-number"),_=Vue.resolveComponent("el-option"),q=Vue.resolveComponent("el-select"),P=Vue.resolveComponent("el-form"),S=Vue.resolveComponent("el-dialog");return Vue.openBlock(),Vue.createElementBlock("div",null,[Vue.createElementVNode("div",I,[Vue.createVNode(n,{modelValue:Vue.unref(f).data.deviceName,"onUpdate:modelValue":t[0]||(t[0]=e=>Vue.unref(f).data.deviceName=e),onKeyup:Vue.withKeys(a,["enter"]),placeholder:"设备名称"},null,8,["modelValue","onKeyup"]),Vue.createElementVNode("div",$,[Vue.createVNode(d,{icon:Vue.unref(T),onClick:a,type:"primary"},{default:Vue.withCtx(()=>[F]),_:1},8,["icon"]),Vue.unref(b)(Vue.unref(m),"admin")?(Vue.openBlock(),Vue.createBlock(d,{key:0,icon:Vue.unref(M),onClick:v,type:"success"},{default:Vue.withCtx(()=>[K]),_:1},8,["icon"])):Vue.createCommentVNode("",!0)])]),Vue.createVNode(D,{"header-cell-style":{background:" rgba(250, 251, 252, 1)",color:"rgba(102, 102, 102, 1)",height:"54px",fontSize:"14px",padding:0,border:"none",boxShadow:"inset 0px -1px 0px  rgba(238, 238, 238, 1),inset 0px 1px 0px  rgba(238, 238, 238, 1)"},data:Vue.unref(C)},{default:Vue.withCtx(()=>[Vue.createVNode(r,{prop:"deviceName",label:"设备名称",width:"256",align:"left"}),Vue.createVNode(r,{prop:"deviceTime",label:"运行时间",width:"256",align:"center"},{default:Vue.withCtx(e=>[Vue.createTextVNode(Vue.toDisplayString(`${e.row.runningHour}:${e.row.runningMinute}`),1)]),_:1}),Vue.createVNode(r,{prop:"unitPrice",label:"单价",width:"256",align:"center"}),Vue.createVNode(r,{prop:"supplierFormat",label:"是否供应商",width:"256",align:"center"}),Vue.createVNode(r,{prop:"sorter",label:"排序",width:"64",align:"left"}),Vue.createVNode(r,{prop:"operator",label:"操作",width:"256"},{default:Vue.withCtx(e=>[Vue.createVNode(E,null,{default:Vue.withCtx(()=>[Vue.unref(b)(Vue.unref(m),"admin")?(Vue.openBlock(),Vue.createBlock(k,{key:0,icon:Vue.unref(U),onClick:Y=>h(e.row,e.$index),class:"mr10",type:"warning"},{default:Vue.withCtx(()=>[j]),_:2},1032,["icon","onClick"])):Vue.createCommentVNode("",!0)]),_:2},1024)]),_:1})]),_:1},8,["header-cell-style","data"]),Vue.createVNode(S,{title:Vue.unref(w)?"Add":"Edit",modelValue:Vue.unref(s),"onUpdate:modelValue":t[8]||(t[8]=e=>Vue.isRef(s)?s.value=e:null),width:"60%","close-on-click-modal":!1},{footer:Vue.withCtx(()=>[Vue.createElementVNode("span",J,[Vue.createVNode(d,{onClick:t[7]||(t[7]=e=>s.value=!1)},{default:Vue.withCtx(()=>[O]),_:1}),Vue.createVNode(d,{type:"primary",onClick:x},{default:Vue.withCtx(()=>[z]),_:1})])]),default:Vue.withCtx(()=>[Vue.createVNode(P,{rules:Vue.unref(y),model:Vue.unref(u),ref_key:"formRef",ref:p,"label-width":"128px"},{default:Vue.withCtx(()=>[Vue.createVNode(i,{prop:"deviceName",label:"设备名称"},{default:Vue.withCtx(()=>[Vue.createVNode(n,{modelValue:Vue.unref(u).deviceName,"onUpdate:modelValue":t[1]||(t[1]=e=>Vue.unref(u).deviceName=e)},null,8,["modelValue"])]),_:1}),Vue.createVNode(i,{prop:"unitPrice",label:"单价"},{default:Vue.withCtx(()=>[Vue.createVNode(c,{modelValue:Vue.unref(u).unitPrice,"onUpdate:modelValue":t[2]||(t[2]=e=>Vue.unref(u).unitPrice=e),min:0,controls:!1},null,8,["modelValue"])]),_:1}),Vue.createVNode(i,{prop:"runningTime",label:"运行时间"},{default:Vue.withCtx(()=>[Vue.createVNode(c,{modelValue:Vue.unref(u).runningHour,"onUpdate:modelValue":t[3]||(t[3]=e=>Vue.unref(u).runningHour=e),style:{width:"60px"},min:0,controls:!1},null,8,["modelValue"]),G,Vue.createVNode(c,{modelValue:Vue.unref(u).runningMinute,"onUpdate:modelValue":t[4]||(t[4]=e=>Vue.unref(u).runningMinute=e),style:{width:"60px"},controls:!1,min:0,max:59},null,8,["modelValue"])]),_:1}),Vue.createVNode(i,{prop:"supplier",label:Vue.unref(V).state.label.supplier},{default:Vue.withCtx(()=>[Vue.createVNode(q,{modelValue:Vue.unref(u).supplier,"onUpdate:modelValue":t[5]||(t[5]=e=>Vue.unref(u).supplier=e),filterable:"","allow-create":"",clearable:"",placeholder:Vue.unref(V).state.label.supplier},{default:Vue.withCtx(()=>[Vue.createVNode(_,{label:"Yes",value:!0}),Vue.createVNode(_,{label:"No",value:!1})]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),Vue.createVNode(i,{prop:"sorter",label:"排序"},{default:Vue.withCtx(()=>[Vue.createVNode(n,{modelValue:Vue.unref(u).sorter,"onUpdate:modelValue":t[6]||(t[6]=e=>Vue.unref(u).sorter=e)},null,8,["modelValue"])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["title","modelValue"])])}}});export{ee as default};
