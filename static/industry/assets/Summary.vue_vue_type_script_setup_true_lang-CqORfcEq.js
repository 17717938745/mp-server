import{s as h}from"./index-DfY7MOwJ.js";import{o,v as u,w as d,h as l}from"./main-Dirrnzcr.js";import{D as v,a as g}from"./Common-dWa9BEsb.js";import{_ as C}from"./ViewList.vue_vue_type_style_index_0_lang-qcv9jr1D.js";const L={class:"query-container"},D={class:"query-btn"},b=Vue.createTextVNode("Search"),q=Vue.defineComponent({__name:"Summary",setup(T){VueRouter.useRouter();const n=Vuex.useStore();n.state.user,n.state.roleCodeList,Vue.ref(null);const m=Vue.ref(new Array),c=Vue.ref([{value:"index",labelKey:"index",width:51},{value:"departmentFormat",labelKey:"department",width:168},{value:"sumUserCountFormat",labelKey:"violationUserCount",width:123},{value:"sumCountFormat",labelKey:"vocationDays",width:128},{value:"sumViolationCountFormat",labelKey:"violationViolationCount",width:110},{value:"complianceRateFormat",labelKey:"violationComplianceRate",width:189}]),e=Vue.reactive({dateTimeList:[u(),d()],userConfigList:new Array,query:{data:{department:"",vocationType:"",user:"",date:"",startDate:o(u(),"yyyy-MM-dd"),endDate:o(d(),"yyyy-MM-dd")},page:{page:g,limit:v}},tableData:new Array,config:{vocationTypeList:[],departmentList:[]}}),y=()=>{e.dateTimeList&&e.dateTimeList.length>1?(e.query.data.startDate=o(e.dateTimeList[0],"yyyy-MM-dd"),e.query.data.endDate=o(e.dateTimeList[1],"yyyy-MM-dd")):(e.query.data.startDate="",e.query.data.endDate=""),s()};Promise.all([l("douson/config",{categoryIdList:["vocationType","department"]}),l("system/user/config/list",{})]).then(t=>{e.config=t[0].data,m.value=(t[1].list||[]).map(a=>({value:a.userId,label:a.name})),s()});const s=()=>{l("douson/admin/vocation/summary-list",e.query.data).then(t=>{e.tableData=t.list,ElementPlus.ElMessage.success("Query success")})},{tableData:p,dateTimeList:r}={...Vue.toRefs(e)};return(t,a)=>{const V=Vue.resolveComponent("el-date-picker"),_=Vue.resolveComponent("el-button"),f=Vue.resolveComponent("el-alert");return Vue.openBlock(),Vue.createElementBlock("div",null,[Vue.createElementVNode("div",L,[Vue.createVNode(V,{modelValue:Vue.unref(r),"onUpdate:modelValue":a[0]||(a[0]=i=>Vue.isRef(r)?r.value=i:null),onChange:y,type:"daterange",format:"YYYY-MM-DD","range-separator":"-","start-placeholder":"Start due date","end-placeholder":"End due date",style:{width:"180px","margin-right":"20px"}},null,8,["modelValue"]),Vue.createElementVNode("div",D,[Vue.createVNode(_,{icon:Vue.unref(h),onClick:s,type:"primary"},{default:Vue.withCtx(()=>[b]),_:1},8,["icon"])])]),Vue.createVNode(f,{title:`${Vue.unref(n).state.label.assemblySummary1Tips}`,type:"info",closable:!0},null,8,["title"]),Vue.createVNode(C,{idKey:"vocationId",columnConfigList:c.value,list:Vue.unref(p)},{operator:Vue.withCtx(i=>[]),_:1},8,["columnConfigList","list"])])}}});export{q as _};
