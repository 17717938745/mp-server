import{s as H,p as O}from"./index-DfY7MOwJ.js";import{o as h,h as M,i as v,p as D,q as G,b as J,u as Q}from"./main-Dirrnzcr.js";import{D as z,a as W}from"./Common-dWa9BEsb.js";import{V}from"./ViewContent.vue_vue_type_script_setup_true_lang-Dpo1Y2zC.js";import{_ as X}from"./ViewList.vue_vue_type_style_index_0_lang-qcv9jr1D.js";import{_ as Z}from"./ImageUpload.vue_vue_type_script_setup_true_lang-BZyBfOer.js";import"./IndustryUtil-CgRifmxX.js";import"./TableViewContent.vue_vue_type_script_setup_true_lang-5zjbO-p-.js";import"./TableColumnViewContent.vue_vue_type_script_setup_true_lang-s5dcpuXa.js";const ee={class:"query-container"},te={class:"query-btn"},ue=Vue.createTextVNode("Search"),le=Vue.createTextVNode("Add "),re=Vue.createTextVNode("导出 Export "),ae={class:"dialog-footer"},oe=Vue.createTextVNode("Cancel"),ne=Vue.createTextVNode("Confirm"),de={class:"dialog-footer"},se=Vue.createTextVNode("Cancel"),ie=Vue.createTextVNode("Confirm"),ye=Vue.defineComponent({__name:"Index",setup(Ve){VueRouter.useRouter();const r=Vuex.useStore(),m=r.state.roleCodeList,w=Vue.ref(null),L=Vue.ref([{value:"expand",label:"",width:48,type:V.Expand},{value:"operator",labelKey:"viewAndEdit",align:"center",width:239,type:V.Operator},{value:"usernameFormat",labelKey:"username",width:128},{value:"reportDate",labelKey:"date",width:108},{value:"orderNo",labelKey:"orderNo",width:100,type:V.OrderLink},{value:"projectSequence",labelKey:"projectSequence",width:64},{value:"designNumber",labelKey:"designNumber",width:160,align:"left"},{value:"testDeviceFormat",labelKey:"testDevice",width:128,type:V.DeviceLink,align:"left"},{value:"processProcedureFormat",labelKey:"processProcedure",width:128,align:"left"},{value:"programNumber",labelKey:"programNumber",width:64},{value:"debugMinute",labelKey:"debugMinute",width:64},{value:"clampingMinute",labelKey:"clampingMinute",width:64},{value:"assistMinute",labelKey:"assistMinute",width:64},{value:"runningMinute",labelKey:"runningMinute",width:80},{value:"productStandMinute",labelKey:"productStandMinute",width:64,type:V.HighLight},{value:"countHour8",labelKey:"countHour8",width:96},{value:"countHour12",labelKey:"countHour12",width:96},{value:"remark",labelKey:"description",width:269,align:"left"},{value:"photoList",labelKey:"photo",width:269,type:V.Image}]),C={productId:"",openId:"",reportDate:h(new Date,"yyyy-MM-dd"),orderNo:"",projectSequence:"",designNumber:"",testDevice:"",processProcedure:"",programNumber:"",debugMinute:0,clampingMinute:0,assistMinute:0,runningMinute:0,remark:"",photoList:new Array},l=Vue.reactive({dateTimeList:[],photoVisible:!1,photoList:new Array,expandRowKeys:new Array,query:{data:{startReportDate:"",endReportDate:"",designNumber:"",testDevice:"",openId:"",nickname:"",processProcedure:"",orderNo:""},page:{page:W,limit:z}},tableData:new Array,total:0,formData:Object.assign({},C),formSave:!1,config:{processProcedureList:[],testDeviceList:[]},formVisible:!1,formRuleList:{reportDate:[{required:!0,message:"请输入",trigger:"blur"}],orderNo:[{required:!0,message:"请输入",trigger:"blur"}],projectSequence:[{required:!0,message:"请输入",trigger:"blur"}],designNumber:[{required:!0,message:"请输入",trigger:"blur"}],testDevice:[{required:!0,message:"请输入",trigger:"blur"}],processProcedure:[{required:!0,message:"请输入",trigger:"blur"}],programNumber:[{required:!0,message:"请输入",trigger:"blur"}],debugMinute:[{required:!0,message:"请输入",trigger:"blur"}],clampingMinute:[{required:!0,message:"请输入",trigger:"blur"}],assistMinute:[{required:!0,message:"请输入",trigger:"blur"}],runningMinute:[{required:!0,message:"请输入",trigger:"blur"}],remark:[{required:!0,message:"请输入",trigger:"blur"}],photoList:[{required:!0,type:"array",message:"必输",min:1,max:4}]}});M("douson/config").then(a=>{l.config=a.data});const q=()=>{l.dateTimeList&&l.dateTimeList.length>1?(l.query.data.startReportDate=h(l.dateTimeList[0],"yyyy-MM-dd hh:mm:ss"),l.query.data.endReportDate=h(l.dateTimeList[1],"yyyy-MM-dd hh:mm:ss")):(l.query.data.startReportDate="",l.query.data.endReportDate=""),n()},n=()=>{M("douson/admin/product/page",l.query).then(a=>{l.tableData=a.list,l.total=a.total,ElementPlus.ElMessage.success("Query success")})},B=a=>{l.query.page.page=a,n()},E=a=>{l.query.page.limit=a,n()};n();const U=()=>{l.formData=Object.assign({},C),l.formVisible=!0,l.formSave=!0},P=a=>{l.formVisible=!0,l.formSave=!1,l.formData=Object.assign({},a)},K=a=>v(m,"admin")?!0:a.creator===r.state.user.userId,S=()=>{w.value.validate(a=>{a&&(l.formSave?G("douson/admin/product",l.formData).then(()=>{l.formVisible=!1,ElementPlus.ElMessage.success("Add success"),n()}):J("douson/admin/product",l.formData).then(()=>{l.formVisible=!1,ElementPlus.ElMessage.success("Update success"),n()}))})},T=()=>{Q("douson/admin/product/export",l.query.data)},{query:d,tableData:I,config:c,total:R,dateTimeList:y,formData:u,formSave:F,formVisible:f,formRuleList:j,photoVisible:p,photoList:k}={...Vue.toRefs(l)};return(a,t)=>{const _=Vue.resolveComponent("el-date-picker"),s=Vue.resolveComponent("el-input"),b=Vue.resolveComponent("el-option"),g=Vue.resolveComponent("el-select"),i=Vue.resolveComponent("el-button"),o=Vue.resolveComponent("el-form-item"),N=Vue.resolveComponent("el-input-number"),A=Vue.resolveComponent("el-form"),x=Vue.resolveComponent("el-dialog"),Y=Vue.resolveComponent("el-image"),$=Vue.resolveComponent("el-empty");return Vue.openBlock(),Vue.createElementBlock("div",null,[Vue.createElementVNode("div",ee,[Vue.createVNode(_,{modelValue:Vue.unref(y),"onUpdate:modelValue":t[0]||(t[0]=e=>Vue.isRef(y)?y.value=e:null),onChange:q,type:"daterange",format:"YYYY-MM-DD","range-separator":"-","start-placeholder":"Start date","end-placeholder":"End date",style:{width:"180px","margin-right":"20px"}},null,8,["modelValue"]),Vue.createVNode(s,{modelValue:Vue.unref(d).data.designNumber,"onUpdate:modelValue":t[1]||(t[1]=e=>Vue.unref(d).data.designNumber=e),onChange:n,placeholder:Vue.unref(r).state.label.designNumber,class:"search-item"},null,8,["modelValue","placeholder"]),Vue.createVNode(g,{modelValue:Vue.unref(d).data.testDevice,"onUpdate:modelValue":t[2]||(t[2]=e=>Vue.unref(d).data.testDevice=e),onChange:n,filterable:"","allow-create":"",clearable:"",placeholder:Vue.unref(r).state.label.testDevice,class:"search-item"},{default:Vue.withCtx(()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(c).testDeviceList,e=>(Vue.openBlock(),Vue.createBlock(b,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"]),Vue.createVNode(s,{modelValue:Vue.unref(d).data.nickname,"onUpdate:modelValue":t[3]||(t[3]=e=>Vue.unref(d).data.nickname=e),onKeyup:Vue.withKeys(n,["enter"]),placeholder:Vue.unref(r).state.label.username,class:"search-item"},null,8,["modelValue","onKeyup","placeholder"]),Vue.createVNode(g,{modelValue:Vue.unref(d).data.processProcedure,"onUpdate:modelValue":t[4]||(t[4]=e=>Vue.unref(d).data.processProcedure=e),onChange:n,clearable:"",placeholder:"Please select"},{default:Vue.withCtx(()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(c).processProcedureList,e=>(Vue.openBlock(),Vue.createBlock(b,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),Vue.createVNode(s,{modelValue:Vue.unref(d).data.orderNo,"onUpdate:modelValue":t[5]||(t[5]=e=>Vue.unref(d).data.orderNo=e),placeholder:Vue.unref(r).state.label.orderNo},null,8,["modelValue","placeholder"]),Vue.createElementVNode("div",te,[Vue.createVNode(i,{icon:Vue.unref(H),onClick:n,type:"primary"},{default:Vue.withCtx(()=>[ue]),_:1},8,["icon"]),Vue.unref(v)(Vue.unref(m),"admin")||Vue.unref(v)(Vue.unref(m),"engineer")?(Vue.openBlock(),Vue.createBlock(i,{key:0,icon:Vue.unref(O),onClick:U,type:"success"},{default:Vue.withCtx(()=>[le]),_:1},8,["icon"])):Vue.createCommentVNode("",!0),Vue.unref(v)(Vue.unref(m),"admin")?(Vue.openBlock(),Vue.createBlock(i,{key:1,class:"login-btn",type:"warning",onClick:T},{default:Vue.withCtx(()=>[re]),_:1})):Vue.createCommentVNode("",!0)])]),Vue.createVNode(X,{idKey:"productId",columnConfigList:L.value,list:Vue.unref(I),handleEdit:P,handleEditShow:K,page:Vue.unref(d).page,total:Vue.unref(R),handlePageChange:B,handleLimitChange:E},{expand:Vue.withCtx(e=>[]),_:1},8,["columnConfigList","list","page","total"]),Vue.createVNode(x,{title:Vue.unref(F)?"Add":"Edit",modelValue:Vue.unref(f),"onUpdate:modelValue":t[22]||(t[22]=e=>Vue.isRef(f)?f.value=e:null),width:"60%","close-on-click-modal":!1},{footer:Vue.withCtx(()=>[Vue.createElementVNode("span",ae,[Vue.createVNode(i,{onClick:t[21]||(t[21]=e=>f.value=!1)},{default:Vue.withCtx(()=>[oe]),_:1}),Vue.createVNode(i,{type:"primary",onClick:S},{default:Vue.withCtx(()=>[ne]),_:1})])]),default:Vue.withCtx(()=>[Vue.createVNode(A,{rules:Vue.unref(j),model:Vue.unref(u),ref_key:"formRef",ref:w,"label-width":"auto","label-position":"top"},{default:Vue.withCtx(()=>[Vue.createVNode(o,{prop:"productId",label:Vue.unref(r).state.label.productId},{default:Vue.withCtx(()=>[Vue.createVNode(s,{modelValue:Vue.unref(u).productId,"onUpdate:modelValue":t[6]||(t[6]=e=>Vue.unref(u).productId=e),disabled:!0},null,8,["modelValue"])]),_:1},8,["label"]),Vue.createVNode(o,{prop:"openId",label:Vue.unref(r).state.label.openId},{default:Vue.withCtx(()=>[Vue.createVNode(s,{modelValue:Vue.unref(u).openId,"onUpdate:modelValue":t[7]||(t[7]=e=>Vue.unref(u).openId=e),disabled:!0},null,8,["modelValue"])]),_:1},8,["label"]),Vue.createVNode(o,{prop:"reportDate",label:Vue.unref(r).state.label.date},{default:Vue.withCtx(()=>[Vue.createVNode(_,{type:"date",modelValue:Vue.unref(u).reportDate,"onUpdate:modelValue":t[8]||(t[8]=e=>Vue.unref(u).reportDate=e),format:"YYYY-MM-DD",onChange:t[9]||(t[9]=e=>Vue.unref(u).reportDate=Vue.unref(h)(Vue.unref(u).reportDate,"yyyy-MM-dd"))},null,8,["modelValue"])]),_:1},8,["label"]),Vue.createVNode(o,{prop:"orderNo",label:Vue.unref(r).state.label.orderNo},{default:Vue.withCtx(()=>[Vue.createVNode(s,{modelValue:Vue.unref(u).orderNo,"onUpdate:modelValue":t[10]||(t[10]=e=>Vue.unref(u).orderNo=e),placeholder:Vue.unref(r).state.label.orderNo},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),Vue.createVNode(o,{prop:"projectSequence",label:Vue.unref(r).state.label.projectSequence},{default:Vue.withCtx(()=>[Vue.createVNode(s,{modelValue:Vue.unref(u).projectSequence,"onUpdate:modelValue":t[11]||(t[11]=e=>Vue.unref(u).projectSequence=e)},null,8,["modelValue"])]),_:1},8,["label"]),Vue.createVNode(o,{prop:"designNumber",label:Vue.unref(r).state.label.designNumber},{default:Vue.withCtx(()=>[Vue.createVNode(s,{modelValue:Vue.unref(u).designNumber,"onUpdate:modelValue":t[12]||(t[12]=e=>Vue.unref(u).designNumber=e)},null,8,["modelValue"])]),_:1},8,["label"]),Vue.createVNode(o,{prop:"testDevice",label:Vue.unref(r).state.label.testDevice},{default:Vue.withCtx(()=>[Vue.createVNode(g,{modelValue:Vue.unref(u).testDevice,"onUpdate:modelValue":t[13]||(t[13]=e=>Vue.unref(u).testDevice=e),filterable:"","allow-create":"",clearable:"",placeholder:"调试设备 Điểu chỉnh máy số",class:"search-item"},{default:Vue.withCtx(()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(c).testDeviceList,e=>(Vue.openBlock(),Vue.createBlock(b,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),Vue.createVNode(o,{prop:"processProcedure",label:Vue.unref(r).state.label.processProcedure},{default:Vue.withCtx(()=>[Vue.createVNode(g,{modelValue:Vue.unref(u).processProcedure,"onUpdate:modelValue":t[14]||(t[14]=e=>Vue.unref(u).processProcedure=e),clearable:"",placeholder:"Please select"},{default:Vue.withCtx(()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(c).processProcedureList,e=>(Vue.openBlock(),Vue.createBlock(b,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),Vue.createVNode(o,{prop:"programNumber",label:Vue.unref(r).state.label.programNumber},{default:Vue.withCtx(()=>[Vue.createVNode(s,{modelValue:Vue.unref(u).programNumber,"onUpdate:modelValue":t[15]||(t[15]=e=>Vue.unref(u).programNumber=e)},null,8,["modelValue"])]),_:1},8,["label"]),Vue.createVNode(o,{prop:"debugMinute",label:Vue.unref(r).state.label.debugMinute},{default:Vue.withCtx(()=>[Vue.createVNode(N,{min:1,modelValue:Vue.unref(u).debugMinute,"onUpdate:modelValue":t[16]||(t[16]=e=>Vue.unref(u).debugMinute=e)},null,8,["modelValue"])]),_:1},8,["label"]),Vue.createVNode(o,{prop:"clampingMinute",label:Vue.unref(r).state.label.clampingMinute},{default:Vue.withCtx(()=>[Vue.createVNode(N,{min:0,modelValue:Vue.unref(u).clampingMinute,"onUpdate:modelValue":t[17]||(t[17]=e=>Vue.unref(u).clampingMinute=e)},null,8,["modelValue"])]),_:1},8,["label"]),Vue.createVNode(o,{prop:"assistMinute",label:Vue.unref(r).state.label.assistMinute},{default:Vue.withCtx(()=>[Vue.createVNode(N,{min:0,modelValue:Vue.unref(u).assistMinute,"onUpdate:modelValue":t[18]||(t[18]=e=>Vue.unref(u).assistMinute=e)},null,8,["modelValue"])]),_:1},8,["label"]),Vue.createVNode(o,{prop:"runningMinute",label:Vue.unref(r).state.label.runningMinute},{default:Vue.withCtx(()=>[Vue.createVNode(N,{min:0,modelValue:Vue.unref(u).runningMinute,"onUpdate:modelValue":t[19]||(t[19]=e=>Vue.unref(u).runningMinute=e)},null,8,["modelValue"])]),_:1},8,["label"]),Vue.createVNode(o,{prop:"remark",label:Vue.unref(r).state.label.description},{default:Vue.withCtx(()=>[Vue.createVNode(s,{modelValue:Vue.unref(u).remark,"onUpdate:modelValue":t[20]||(t[20]=e=>Vue.unref(u).remark=e)},null,8,["modelValue"])]),_:1},8,["label"]),Vue.createVNode(o,{prop:"photoList",label:Vue.unref(r).state.label.photo},{default:Vue.withCtx(()=>[Vue.createVNode(Z,{photoList:Vue.unref(u).photoList},null,8,["photoList"])]),_:1},8,["label"])]),_:1},8,["rules","model"])]),_:1},8,["title","modelValue"]),Vue.createVNode(x,{title:"查看照片",modelValue:Vue.unref(p),"onUpdate:modelValue":t[25]||(t[25]=e=>Vue.isRef(p)?p.value=e:null),width:"60%"},{footer:Vue.withCtx(()=>[Vue.createElementVNode("span",de,[Vue.createVNode(i,{onClick:t[23]||(t[23]=e=>p.value=!1)},{default:Vue.withCtx(()=>[se]),_:1}),Vue.createVNode(i,{type:"primary",onClick:t[24]||(t[24]=e=>p.value=!1)},{default:Vue.withCtx(()=>[ie]),_:1})])]),default:Vue.withCtx(()=>[Vue.unref(k).length>0?(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,{key:0},Vue.renderList(Vue.unref(k),e=>(Vue.openBlock(),Vue.createBlock(Y,{src:Vue.unref(D)(e.photoCompressUrl,""),fit:"cover","preview-src-list":[Vue.unref(D)(e.photoUrl,"")],"initial-index":0,class:"image-view"},null,8,["src","preview-src-list"]))),256)):(Vue.openBlock(),Vue.createBlock($,{key:1,description:"Empty"}))]),_:1},8,["modelValue"])])}}});export{ye as default};
