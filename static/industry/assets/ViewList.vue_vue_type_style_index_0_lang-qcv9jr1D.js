import{V as k,_ as z}from"./ViewContent.vue_vue_type_script_setup_true_lang-Dpo1Y2zC.js";import{z as q,A as J}from"./main-Dirrnzcr.js";import{P as Q}from"./Common-dWa9BEsb.js";import{h as N}from"./IndustryUtil-CgRifmxX.js";import{_ as X}from"./TableViewContent.vue_vue_type_script_setup_true_lang-5zjbO-p-.js";const Y={key:0},ee=Vue.createTextVNode("` "),le={style:{display:"flex","flex-direction":"column","align-items":"center","justify-content":"flex-start","margin-bottom":"20px",position:"absolute",width:"100%",top:"20px"},id:"printContainer"},te={style:{display:"flex","flex-direction":"column","align-items":"center","justify-content":"center",width:"595px"}},ne={key:0},ae={key:1},oe={key:2,style:{display:"flex","justify-content":"flex-end",width:"100%"}},ue=Vue.createTextVNode("` "),me=Vue.defineComponent({__name:"ViewList",props:{idKey:null,columnConfigList:null,list:null,total:{default:-1},handleEdit:null,handleUpdate:null,handleEditShow:null,handleDeleteShow:null,handleDelete:null,page:null,handlePageChange:null,handleLimitChange:null,handleTableRowClassName:null,handleTableCellClassName:null,handleSelectionChange:null,detailLink:{type:Boolean,default:!0}},emits:[],setup(R,{expose:P,emit:re}){const e=R;VueRouter.useRouter(),VueRouter.useRoute();const v=Vuex.useStore();v.state.roleCodeList;const D=`${e.idKey}_scale`,m={},u=Vue.ref(Number(q(D)||"1")),L=Math.max(window.innerHeight-380,550),F=Vue.ref(Math.max(2,1+Number((window.innerWidth/256).toFixed(0))));Vue.ref(Math.max(2,1+Number((window.innerWidth*.8/256).toFixed(0))));const p=Vue.ref(window.innerWidth>=512),C=Vue.ref(L/u.value),b=Vue.ref(!1),$=Vue.ref({}),A=()=>{C.value=L/u.value,J(D,u.value)},H=()=>{document.body.style.height=j,b.value=!1},I=l=>{console.log(`e: ${l}`)},M=Vue.ref([]),V=Vue.ref(e.columnConfigList),c=Vue.ref(V.value.filter(l=>l.children&&l.children.length>0).map(l=>l.labelKey||l.label||"")),g=Vue.ref(c.value.map(l=>l)),x=Vue.ref(e.list);P({});const j=document.body.style.height,K=l=>{b.value=!0,$.value=l;const n=document.getElementsByClassName("view-list-print-drawer"),r=n[n.length-1];setTimeout(()=>{S(r,r,"el-descriptions")},500)},S=(l,n=l,r,a=!0)=>{const f=n.children||[];let o=null;for(let h=0;h<f.length;h++){const i=f[h];if((i.getAttribute("class")||"").indexOf(r)>=0?(o=i,console.log(`content height: ${o.offsetHeight}, r: ${o}`),l.style.height=o.offsetHeight+600+"px"):o=S(l,i,r,!1),o!==null)break}return!o&&a&&setTimeout(()=>{S(l,n,r)},100),o},G=()=>N(V.value,[k.Image,k.Video],!1,!0,c.value,g.value),T=()=>{for(let a in m)delete m[a];const l=G(),n=x.value,r=n.length;for(let a=0;a<r;a++){const f=n[a];for(let o=0;o<l.length;o++){const h=l[o];if(h.mergeKey){const i=o,w=h.mergeKey;if(!m[`${a}-${i}`]){let y=a;for(;++y<r;){const E=n[y];let _=!0;for(let t=0;t<w.length;t++){const s=w[t];if(f[s]!==E[s]){_=!1;break}}if(_)m[`${y}-${i}`]={rowspan:0,colspan:0};else break}m[`${a}-${i}`]={rowspan:y-a,colspan:1}}}}}},W=({row:l,column:n,rowIndex:r,columnIndex:a})=>m[`${r}-${a}`]||{rowspan:1,colspan:1},O=({row:l,rowIndex:n})=>l.valid?"row-done":"";return Vue.watch(()=>e.list,l=>{x.value=l,T()},{immediate:!0}),Vue.watch(()=>e.columnConfigList,l=>{V.value=l,T()},{immediate:!0}),(l,n)=>{const r=Vue.resolveComponent("el-switch"),a=Vue.resolveComponent("el-input-number"),f=Vue.resolveComponent("el-space"),o=Vue.resolveComponent("el-checkbox"),h=Vue.resolveComponent("el-checkbox-group"),i=Vue.resolveComponent("el-descriptions-item"),w=Vue.resolveComponent("el-descriptions"),y=Vue.resolveComponent("el-table"),E=Vue.resolveComponent("el-pagination"),_=Vue.resolveComponent("el-drawer");return Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,null,[Vue.createElementVNode("div",null,[Vue.createVNode(f,{wrap:""},{default:Vue.withCtx(()=>[Vue.createVNode(r,{modelValue:p.value,"onUpdate:modelValue":n[0]||(n[0]=t=>p.value=t),"active-text":"PC model","inactive-text":"Mobile model"},null,8,["modelValue"]),p.value?(Vue.openBlock(),Vue.createBlock(a,{key:0,modelValue:u.value,"onUpdate:modelValue":n[1]||(n[1]=t=>u.value=t),min:.2,max:1,step:.05,"step-strictly":"",style:{"margin-left":"20px"},onChange:A},null,8,["modelValue","min","step"])):Vue.createCommentVNode("",!0)]),_:1})]),c.value&&c.value.length>0?(Vue.openBlock(),Vue.createElementBlock("div",Y,[Vue.createVNode(h,{modelValue:g.value,"onUpdate:modelValue":n[2]||(n[2]=t=>g.value=t),onChange:I},{default:Vue.withCtx(()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(c.value,(t,s)=>(Vue.openBlock(),Vue.createBlock(o,{key:t,label:t,value:t},{default:Vue.withCtx(()=>[Vue.createTextVNode(Vue.toDisplayString(Vue.unref(v).state.label[t]||t),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])])):Vue.createCommentVNode("",!0),p.value?Vue.createCommentVNode("",!0):(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,{key:1},Vue.renderList(x.value,(t,s)=>(Vue.openBlock(),Vue.createBlock(w,{key:"des-"+s,title:`Submit info ${s+1}`,direction:"vertical",column:F.value,style:{"margin-bottom":"20px"},border:""},{default:Vue.withCtx(()=>[ee,(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(N)(V.value,[Vue.unref(k).Expand],!0,!1,c.value,g.value),(d,U)=>(Vue.openBlock(),Vue.createBlock(i,{key:d.value,label:d.labelKey?Vue.unref(v).state.label[d.labelKey]:d.label,align:d.align||"center"},{default:Vue.withCtx(()=>[Vue.createVNode(z,{idKey:e.idKey,viewConfig:d,row:t,handleShowDetail:e.detailLink?K:null,handleEdit:e.handleEdit,handleUpdate:e.handleUpdate,handleEditShow:e.handleEditShow,handleDeleteShow:e.handleDeleteShow,handleDelete:e.handleDelete},{expand:Vue.withCtx(B=>[Vue.renderSlot(l.$slots,"expand",{param:B.param})]),template:Vue.withCtx(({param:B,viewConfig:Z})=>[Vue.renderSlot(l.$slots,"template",{param:B,viewConfig:Z})]),_:2},1032,["idKey","viewConfig","row","handleShowDetail","handleEdit","handleUpdate","handleEditShow","handleDeleteShow","handleDelete"])]),_:2},1032,["label","align"]))),128))]),_:2},1032,["title","column"]))),128)),p.value?(Vue.openBlock(),Vue.createBlock(y,{key:2,ref:"tableRef","header-cell-style":{background:" rgba(250, 251, 252, 1)",color:"rgba(102, 102, 102, 1)",height:"54px",fontSize:"14px",padding:0,boxShadow:"inset 0px -1px 0px  rgba(238, 238, 238, 1),inset 0px 1px 0px  rgba(238, 238, 238, 1)"},border:!0,data:x.value,size:"small","row-key":e.idKey,"expand-row-keys":M.value,height:C.value,"row-class-name":e.handleTableRowClassName||O,"cell-class-name":e.handleTableCellClassName,"span-method":W,style:Vue.normalizeStyle({transform:`scale(${u.value})`,width:`${100*(1/u.value)}% !important`,maxWidth:`${100*(1/u.value)}% !important`,marginLeft:`${100*(1/u.value-1)/-2}%`,marginTop:`${C.value*(1-u.value)/-2}px`,display:u.value===1?"":"block"}),onSelectionChange:e.handleSelectionChange},{default:Vue.withCtx(()=>[Vue.createVNode(X,{idKey:e.idKey,viewConfigList:V.value,handleShowDetail:e.detailLink?K:null,handleEdit:e.handleEdit,handleUpdate:e.handleUpdate,handleEditShow:e.handleEditShow,handleDeleteShow:e.handleDeleteShow,handleDelete:e.handleDelete,groupList:c.value,checkedGroupList:g.value,scale:u.value},{operator:Vue.withCtx(t=>[Vue.renderSlot(l.$slots,"operator",{param:t.param})]),template:Vue.withCtx(({param:t,viewConfig:s})=>[Vue.renderSlot(l.$slots,"template",{param:t,viewConfig:s})]),_:3},8,["idKey","viewConfigList","handleShowDetail","handleEdit","handleUpdate","handleEditShow","handleDeleteShow","handleDelete","groupList","checkedGroupList","scale"])]),_:3},8,["header-cell-style","data","row-key","expand-row-keys","height","row-class-name","cell-class-name","style","onSelectionChange"])):Vue.createCommentVNode("",!0),e.total>=0?(Vue.openBlock(),Vue.createBlock(E,{key:3,background:"","page-sizes":Vue.unref(Q),currentPage:e.page.page,"onUpdate:currentPage":n[3]||(n[3]=t=>e.page.page=t),"page-size":e.page.limit,total:e.total,onCurrentChange:e.handlePageChange,onSizeChange:e.handleLimitChange,layout:"total, sizes, prev, pager, next, jumper",style:Vue.normalizeStyle({marginTop:p.value?`${C.value*(1-u.value)/-2}px`:0})},null,8,["page-sizes","currentPage","page-size","total","onCurrentChange","onSizeChange","style"])):Vue.createCommentVNode("",!0),e.detailLink?(Vue.openBlock(),Vue.createBlock(_,{key:4,modelValue:b.value,"onUpdate:modelValue":n[4]||(n[4]=t=>b.value=t),size:"100%","append-to-body":!0,"lock-scroll":!1,"modal-class":"view-list-print-drawer","before-close":H,"z-index":99999},{default:Vue.withCtx(()=>[Vue.createElementVNode("div",le,[Vue.createElementVNode("div",te,[e.detailTitle?(Vue.openBlock(),Vue.createElementBlock("h1",ne,Vue.toDisplayString(e.detailTitle),1)):(Vue.openBlock(),Vue.createElementBlock("h1",ae,Vue.toDisplayString(Vue.unref(v).state.label[e.idKey.substring(0,e.idKey.length-2)]),1)),e.detailSubTitle?(Vue.openBlock(),Vue.createElementBlock("div",oe,[Vue.createElementVNode("h5",null,Vue.toDisplayString(e.detailSubTitle),1)])):Vue.createCommentVNode("",!0),Vue.createVNode(w,{column:1,style:{width:"100%"},border:""},{default:Vue.withCtx(()=>[ue,(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(N)(V.value,[Vue.unref(k).Expand,Vue.unref(k).Operator],!0,!1,c.value,g.value),(t,s)=>(Vue.openBlock(),Vue.createBlock(i,{key:t.value,label:t.labelKey?Vue.unref(v).state.label[t.labelKey]:t.label,align:"center","label-class-name":"print-label"},{default:Vue.withCtx(()=>[Vue.createVNode(z,{idKey:e.idKey,viewConfig:t,row:$.value,handleEdit:e.handleEdit,handleUpdate:e.handleUpdate,handleEditShow:e.handleEditShow,handleDelete:e.handleDelete,fullMessage:!0},{expand:Vue.withCtx(d=>[Vue.renderSlot(l.$slots,"expand",{param:d.param})]),template:Vue.withCtx(({param:d,viewConfig:U})=>[Vue.renderSlot(l.$slots,"template",{param:d,viewConfig:U})]),_:2},1032,["idKey","viewConfig","row","handleEdit","handleUpdate","handleEditShow","handleDelete"])]),_:2},1032,["label"]))),128))]),_:3})])])]),_:3},8,["modelValue"])):Vue.createCommentVNode("",!0)],64)}}});export{me as _};
