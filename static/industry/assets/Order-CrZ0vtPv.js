import{s as B}from"./index-DfY7MOwJ.js";import{h as v,i as K,q as U,b as j}from"./main-Dirrnzcr.js";import{D as R,a as A}from"./Common-dWa9BEsb.js";import{_ as F}from"./ViewList.vue_vue_type_style_index_0_lang-qcv9jr1D.js";import{V as I}from"./ViewContent.vue_vue_type_script_setup_true_lang-Dpo1Y2zC.js";import"./IndustryUtil-CgRifmxX.js";import"./TableViewContent.vue_vue_type_script_setup_true_lang-5zjbO-p-.js";import"./TableColumnViewContent.vue_vue_type_script_setup_true_lang-s5dcpuXa.js";const T={class:"query-container"},M={class:"query-btn"},O=Vue.createTextVNode("Search"),$={class:"dialog-footer"},G=Vue.createTextVNode("Cancel"),J=Vue.createTextVNode("Confirm"),le=Vue.defineComponent({__name:"Order",setup(Q){const r=Vuex.useStore(),g=r.state.roleCodeList;VueRouter.useRouter();const C=VueRouter.useRoute(),p=Vue.ref(null),h=String(C.query.orderId||""),l=Vue.reactive({query:{data:{orderId:"",testDevice:"",orderNo:"",designNumber:"",projectSequence:""},page:{page:A,limit:R}},config:{processProcedureList:[],testDeviceList:[]},total:0,tableData:new Array,formData:{orderId:"",orderNo:"",projectSequence:"",testDevice:"",processProcedure:"",orderCount:0},formSave:!1,formVisible:!1,formRuleList:{orderCount:[{required:!0,message:"请输入",trigger:"blur"}]}}),a=()=>b(""),b=(u="")=>{l.query.data.orderId=u,v("douson/admin/order/page",l.query).then(t=>{l.total=t.total;const s=t.list||[];l.tableData=s,u&&s.length>0&&(l.formVisible=!0,l.formData=Object.assign({},s[0])),ElementPlus.ElMessage.success("Query success")})};b(h);const N=(u,t=0)=>{l.formVisible=!0,l.formSave=!1,l.formData=Object.assign({},u)},_=()=>{p.value.validate(u=>{u&&(l.formSave?U("douson/admin/order",l.formData).then(()=>{l.formVisible=!1,ElementPlus.ElMessage.success("Add success"),a()}):j("douson/admin/order",l.formData).then(()=>{l.formVisible=!1,ElementPlus.ElMessage.success("Update success"),a()}))})},y=u=>{l.query.page.page=u,a()},w=u=>{l.query.page.limit=u,a()};v("douson/config").then(u=>{l.config=u.data});const D=Vue.ref([{value:"orderNo",labelKey:"orderNo",width:128,align:"left"},{value:"projectSequence",labelKey:"projectSequence",width:128,align:"left"},{value:"testDeviceFormat",labelKey:"testDevice",width:160,align:"left"},{value:"processProcedureFormat",labelKey:"processProcedure",width:128,align:"left"},{value:"orderCount",labelKey:"orderCount",width:128,align:"center"},{value:"designNumber",labelKey:"designNumber",width:160,align:"left"},{value:"operator",labelKey:"viewAndEdit",width:289,type:I.Operator}]),{query:n,config:i,total:k,tableData:q,formData:o,formSave:x,formVisible:V,formRuleList:E}={...Vue.toRefs(l)};return(u,t)=>{const s=Vue.resolveComponent("el-input"),c=Vue.resolveComponent("el-option"),f=Vue.resolveComponent("el-select"),m=Vue.resolveComponent("el-button"),d=Vue.resolveComponent("el-form-item"),L=Vue.resolveComponent("el-input-number"),P=Vue.resolveComponent("el-form"),S=Vue.resolveComponent("el-dialog");return Vue.openBlock(),Vue.createElementBlock("div",null,[Vue.createElementVNode("div",T,[Vue.createVNode(s,{modelValue:Vue.unref(n).data.orderNo,"onUpdate:modelValue":t[0]||(t[0]=e=>Vue.unref(n).data.orderNo=e),onKeyup:Vue.withKeys(a,["enter"]),placeholder:Vue.unref(r).state.label.orderNo},null,8,["modelValue","onKeyup","placeholder"]),Vue.createVNode(s,{modelValue:Vue.unref(n).data.projectSequence,"onUpdate:modelValue":t[1]||(t[1]=e=>Vue.unref(n).data.projectSequence=e),onKeyup:Vue.withKeys(a,["enter"]),placeholder:Vue.unref(r).state.label.projectSequence},null,8,["modelValue","onKeyup","placeholder"]),Vue.createVNode(f,{modelValue:Vue.unref(n).data.testDevice,"onUpdate:modelValue":t[2]||(t[2]=e=>Vue.unref(n).data.testDevice=e),onChange:a,filterable:"","allow-create":"",clearable:"",placeholder:Vue.unref(r).state.label.testDevice,class:"search-item"},{default:Vue.withCtx(()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(i).testDeviceList,e=>(Vue.openBlock(),Vue.createBlock(c,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"]),Vue.createVNode(s,{modelValue:Vue.unref(n).data.designNumber,"onUpdate:modelValue":t[3]||(t[3]=e=>Vue.unref(n).data.designNumber=e),onChange:a,placeholder:Vue.unref(r).state.label.designNumber,class:"search-item"},null,8,["modelValue","placeholder"]),Vue.createElementVNode("div",M,[Vue.createVNode(m,{icon:Vue.unref(B),onClick:a,type:"primary"},{default:Vue.withCtx(()=>[O]),_:1},8,["icon"])])]),Vue.createVNode(F,{idKey:"orderId",columnConfigList:D.value,list:Vue.unref(q),handleEdit:Vue.unref(K)(Vue.unref(g),"admin")?N:null,page:Vue.unref(n).page,total:Vue.unref(k),handlePageChange:y,handleLimitChange:w},null,8,["columnConfigList","list","handleEdit","page","total"]),Vue.createVNode(S,{title:Vue.unref(x)?"Add":"Edit",modelValue:Vue.unref(V),"onUpdate:modelValue":t[11]||(t[11]=e=>Vue.isRef(V)?V.value=e:null),width:"60%","close-on-click-modal":!1},{footer:Vue.withCtx(()=>[Vue.createElementVNode("span",$,[Vue.createVNode(m,{onClick:t[10]||(t[10]=e=>V.value=!1)},{default:Vue.withCtx(()=>[G]),_:1}),Vue.createVNode(m,{type:"primary",onClick:_},{default:Vue.withCtx(()=>[J]),_:1})])]),default:Vue.withCtx(()=>[Vue.createVNode(P,{rules:Vue.unref(E),model:Vue.unref(o),ref_key:"formRef",ref:p,"label-width":"128px"},{default:Vue.withCtx(()=>[Vue.createVNode(d,{prop:"orderNo",label:Vue.unref(r).state.label.orderNo},{default:Vue.withCtx(()=>[Vue.createVNode(s,{modelValue:Vue.unref(o).orderNo,"onUpdate:modelValue":t[4]||(t[4]=e=>Vue.unref(o).orderNo=e),onChange:t[5]||(t[5]=e=>Vue.unref(o).orderNo=(Vue.unref(o).orderNo||"").toUpperCase())},null,8,["modelValue"])]),_:1},8,["label"]),Vue.createVNode(d,{prop:"projectSequence",label:Vue.unref(r).state.label.projectSequence},{default:Vue.withCtx(()=>[Vue.createVNode(s,{modelValue:Vue.unref(o).projectSequence,"onUpdate:modelValue":t[6]||(t[6]=e=>Vue.unref(o).projectSequence=e)},null,8,["modelValue"])]),_:1},8,["label"]),Vue.createVNode(d,{prop:"testDevice",label:Vue.unref(r).state.label.testDevice},{default:Vue.withCtx(()=>[Vue.createVNode(f,{modelValue:Vue.unref(o).testDevice,"onUpdate:modelValue":t[7]||(t[7]=e=>Vue.unref(o).testDevice=e),filterable:"",clearable:"",placeholder:Vue.unref(r).state.label.testDevice,class:"search-item"},{default:Vue.withCtx(()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(i).testDeviceList,e=>(Vue.openBlock(),Vue.createBlock(c,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),Vue.createVNode(d,{prop:"processProcedure",label:Vue.unref(r).state.label.processProcedure},{default:Vue.withCtx(()=>[Vue.createVNode(f,{modelValue:Vue.unref(o).processProcedure,"onUpdate:modelValue":t[8]||(t[8]=e=>Vue.unref(o).processProcedure=e),filterable:"",clearable:"",placeholder:Vue.unref(r).state.label.processProcedure},{default:Vue.withCtx(()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(i).processProcedureList,e=>(Vue.openBlock(),Vue.createBlock(c,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),Vue.createVNode(d,{prop:"orderCount",label:Vue.unref(r).state.label.orderCount},{default:Vue.withCtx(()=>[Vue.createVNode(L,{modelValue:Vue.unref(o).orderCount,"onUpdate:modelValue":t[9]||(t[9]=e=>Vue.unref(o).orderCount=e),min:0,controls:!1},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["rules","model"])]),_:1},8,["title","modelValue"])])}}});export{le as default};
