import{s as G,p as J,m as Q}from"./index-DfY7MOwJ.js";import{o as h,h as N,i as D,q as H,b as W,a as X}from"./main-Dirrnzcr.js";import{D as Z,a as ee}from"./Common-dWa9BEsb.js";import{V as b}from"./ViewContent.vue_vue_type_script_setup_true_lang-Dpo1Y2zC.js";import{_ as te}from"./ViewList.vue_vue_type_style_index_0_lang-qcv9jr1D.js";import{_ as le}from"./ImageUpload.vue_vue_type_script_setup_true_lang-BZyBfOer.js";import{_ as ae}from"./FileUpload.vue_vue_type_script_setup_true_lang-BoA0mtAu.js";import"./IndustryUtil-CgRifmxX.js";import"./TableViewContent.vue_vue_type_script_setup_true_lang-5zjbO-p-.js";import"./TableColumnViewContent.vue_vue_type_script_setup_true_lang-s5dcpuXa.js";const ue={class:"query-container"},oe={class:"query-btn"},ne=Vue.createTextVNode("Search"),re=Vue.createTextVNode("Add"),ie=Vue.createTextVNode("Print"),se={class:"dialog-footer"},de=Vue.createTextVNode("Cancel"),Ve=Vue.createTextVNode("Confirm"),we=Vue.defineComponent({__name:"Equipment",setup(me){VueRouter.useRouter();const U=VueRouter.useRoute(),o=Vuex.useStore(),v=o.state.roleCodeList,w=o.state.user,C=Vue.ref(null);Vue.ref(["0"]);const g=Vue.ref(new Array),P=Vue.ref([{value:"expand",label:"",width:48,type:b.Expand},{value:"operator",labelKey:"viewAndEdit",align:"center",width:248,type:b.Operator},{value:"index",labelKey:"index",width:80},{value:"equipmentNo",labelKey:"equipmentNo",width:146},{value:"equipmentName",labelKey:"equipmentName",width:232},{value:"specification",labelKey:"specification",width:265},{value:"date",labelKey:"date",width:100},{value:"useUserFormat",labelKey:"useUser",width:289},{value:"remark",labelKey:"description",width:232,showOverflow:!0},{value:"detailDescribe",labelKey:"equipmentDetailDescribe",width:232,showOverflow:!0},{value:"gasolineType",labelKey:"gasolineType",width:187,showOverflow:!0},{value:"chargeUserFormat",labelKey:"chargeUser",width:135,showOverflow:!0},{value:"positionFormat",labelKey:"equipmentPosition",width:189},{value:"photoList",labelKey:"photo",width:128,type:b.Image},{value:"fileList",labelKey:"supportAttachment",width:128,type:b.Attachment}]),E=u=>{window.open(`/industry/public/equipment?equipmentId=${u.param.equipmentId}`)},x={equipmentId:"",equipmentNo:"",equipmentName:"",specification:"",date:h(new Date,"yyyy-MM-dd"),useUserList:[w.userId],remark:"",detailDescribe:"",gasolineType:"",chargeUser:"",chargeUserList:[],position:"",photoList:[],fileList:[]},l=Vue.reactive({dateTimeList:[],expandRowKeys:[],query:{data:{equipmentId:U.query.equipmentId,equipmentNo:"",equipmentName:"",specification:"",startDate:"",endDate:"",useUser:"",remark:"",detailDescribe:"",chargeUser:"",position:""},page:{page:ee,limit:Z}},tableData:new Array,total:0,formData:Object.assign({},x),formSave:!1,config:{equipmentNoList:[],equipmentPositionList:[]},userOptionList:new Array,formVisible:!1,formRuleList:{equipmentNo:[{required:!0,message:"Please check",trigger:"blur"}],equipmentName:[{required:!0,message:"Please check",trigger:"blur"}],specification:[{required:!0,message:"Please check",trigger:"blur"}],date:[{required:!0,message:"Please check",trigger:"blur"}],useUserList:[{required:!0,type:"array",message:"Please check",min:1,max:999}],position:[{required:!0,message:"Please check",trigger:"blur"}],photoList:[{required:!1,type:"array",message:"Please check",min:0,max:10}],fileList:[{required:!1,type:"array",message:"Please check",min:0,max:10}]}});Promise.all([N("douson/config",{categoryIdList:["equipmentNo","equipmentPosition"]}),N("system/user/config/list",{})]).then(u=>{l.config=u[0].data,g.value=(u[1].list||[]).map(t=>({value:t.userId,label:t.name})),n()});const n=()=>{k(!1),N("douson/admin/equipment/page",l.query).then(u=>{const t=u.list||[];l.tableData=t,l.total=u.total,ElementPlus.ElMessage.success("Query success")})},M=u=>{l.query.page.page=u,n()},B=u=>{l.query.page.limit=u,n()},T=()=>{l.formData=Object.assign({},x),l.formVisible=!0,l.formSave=!0},I=u=>{l.formVisible=!0,l.formSave=!1,l.formData=Object.assign({},u)},K=u=>!!D(v,"equipmentManager"),$=()=>{C.value.validate((u,t)=>{u?l.formSave?H("douson/admin/equipment",l.formData).then(()=>{l.formVisible=!1,ElementPlus.ElMessage.success("Add success"),n()}):_(l.formData):ElementPlus.ElMessage.error("Please check input")})},_=u=>W("douson/admin/equipment",u).then(()=>{l.formVisible=!1,ElementPlus.ElMessage.success("Update success"),n()}),S=u=>{ElementPlus.ElMessageBox.confirm("Confirm Delete?","Tips",{type:"warning"}).then(()=>{X("douson/admin/equipment",{equipmentId:u.equipmentId}).then(()=>{ElementPlus.ElMessage.success("Delete success"),n()})})},k=(u=!0)=>{l.dateTimeList&&l.dateTimeList.length>1?(l.query.data.startDate=h(l.dateTimeList[0],"yyyy-MM-dd hh:mm:ss"),l.query.data.endDate=h(l.dateTimeList[1],"yyyy-MM-dd hh:mm:ss")):(l.query.data.startDate="",l.query.data.endDate=""),u&&n()},{query:i,tableData:A,config:y,total:R,dateTimeList:q,formData:a,formSave:F,formVisible:c,formRuleList:V}={...Vue.toRefs(l)};return(u,t)=>{const d=Vue.resolveComponent("el-input"),L=Vue.resolveComponent("el-date-picker"),m=Vue.resolveComponent("el-option"),p=Vue.resolveComponent("el-select"),f=Vue.resolveComponent("el-button"),O=Vue.resolveComponent("el-tag"),Y=Vue.resolveComponent("el-link"),r=Vue.resolveComponent("el-form-item"),z=Vue.resolveComponent("el-form"),j=Vue.resolveComponent("el-dialog");return Vue.openBlock(),Vue.createElementBlock("div",null,[Vue.createElementVNode("div",ue,[Vue.createVNode(d,{modelValue:Vue.unref(i).data.equipmentId,"onUpdate:modelValue":t[0]||(t[0]=e=>Vue.unref(i).data.equipmentId=e),onKeyup:Vue.withKeys(n,["enter"]),placeholder:Vue.unref(o).state.label.equipmentId,clearable:"",onChange:n,class:"search-item"},null,8,["modelValue","onKeyup","placeholder"]),Vue.createVNode(L,{modelValue:Vue.unref(q),"onUpdate:modelValue":t[1]||(t[1]=e=>Vue.isRef(q)?q.value=e:null),onChange:k,type:"daterange",format:"YYYY-MM-DD","range-separator":"-","start-placeholder":"Start date","end-placeholder":"End date",style:{width:"180px","margin-right":"20px"}},null,8,["modelValue"]),Vue.createVNode(p,{modelValue:Vue.unref(i).data.equipmentId,"onUpdate:modelValue":t[2]||(t[2]=e=>Vue.unref(i).data.equipmentId=e),onChange:n,filterable:"","allow-create":"",clearable:"",placeholder:Vue.unref(o).state.label.equipmentNo},{default:Vue.withCtx(()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(y).equipmentNoList,e=>(Vue.openBlock(),Vue.createBlock(m,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"]),Vue.createVNode(d,{modelValue:Vue.unref(i).data.equipmentName,"onUpdate:modelValue":t[3]||(t[3]=e=>Vue.unref(i).data.equipmentName=e),onChange:n,placeholder:Vue.unref(o).state.label.equipmentName,class:"search-item"},null,8,["modelValue","placeholder"]),Vue.createVNode(d,{modelValue:Vue.unref(i).data.specification,"onUpdate:modelValue":t[4]||(t[4]=e=>Vue.unref(i).data.specification=e),onChange:n,placeholder:Vue.unref(o).state.label.specification,class:"search-item"},null,8,["modelValue","placeholder"]),Vue.createVNode(p,{modelValue:Vue.unref(i).data.position,"onUpdate:modelValue":t[5]||(t[5]=e=>Vue.unref(i).data.position=e),onChange:n,filterable:"","allow-create":"",clearable:"",placeholder:Vue.unref(o).state.label.equipmentPosition},{default:Vue.withCtx(()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(y).equipmentPositionList,e=>(Vue.openBlock(),Vue.createBlock(m,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"]),Vue.createElementVNode("div",oe,[Vue.createVNode(f,{icon:Vue.unref(G),onClick:n,type:"primary"},{default:Vue.withCtx(()=>[ne]),_:1},8,["icon"]),Vue.unref(D)(Vue.unref(v),"equipmentManager")?(Vue.openBlock(),Vue.createBlock(f,{key:0,icon:Vue.unref(J),onClick:T,type:"success"},{default:Vue.withCtx(()=>[re]),_:1},8,["icon"])):Vue.createCommentVNode("",!0)])]),Vue.createVNode(te,{idKey:"equipmentId",columnConfigList:P.value,list:Vue.unref(A),handleEdit:I,handleEditShow:K,handleUpdate:_,handleDelete:Vue.unref(w).username==="admin"?S:null,page:Vue.unref(i).page,total:Vue.unref(R),handlePageChange:M,handleLimitChange:B,detailLink:!1},{operator:Vue.withCtx(e=>[Vue.createVNode(Y,{icon:Vue.unref(Q),onClick:s=>E(e),class:"mr10",type:"info"},{default:Vue.withCtx(()=>[Vue.createVNode(O,{size:"small"},{default:Vue.withCtx(()=>[ie]),_:1})]),_:2},1032,["icon","onClick"])]),_:1},8,["columnConfigList","list","handleDelete","page","total"]),Vue.createVNode(j,{title:Vue.unref(F)?"Add":"Edit",modelValue:Vue.unref(c),"onUpdate:modelValue":t[18]||(t[18]=e=>Vue.isRef(c)?c.value=e:null),width:"60%","close-on-click-modal":!1},{footer:Vue.withCtx(()=>[Vue.createElementVNode("span",se,[Vue.createVNode(f,{onClick:t[17]||(t[17]=e=>c.value=!1)},{default:Vue.withCtx(()=>[de]),_:1}),Vue.createVNode(f,{type:"primary",onClick:$},{default:Vue.withCtx(()=>[Ve]),_:1})])]),default:Vue.withCtx(()=>[Vue.createVNode(z,{rules:Vue.unref(V),model:Vue.unref(a),ref_key:"formRef",ref:C,"label-width":"auto","label-position":"top"},{default:Vue.withCtx(()=>[Vue.createVNode(r,{prop:"equipmentNo",label:Vue.unref(o).state.label.equipmentId},{default:Vue.withCtx(()=>[Vue.createVNode(d,{modelValue:Vue.unref(a).equipmentNo,"onUpdate:modelValue":t[6]||(t[6]=e=>Vue.unref(a).equipmentNo=e),placeholder:Vue.unref(o).state.label.equipmentNo},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),Vue.createVNode(r,{prop:"equipmentName",label:Vue.unref(o).state.label.equipmentName},{default:Vue.withCtx(()=>[Vue.createVNode(d,{modelValue:Vue.unref(a).equipmentName,"onUpdate:modelValue":t[7]||(t[7]=e=>Vue.unref(a).equipmentName=e),placeholder:Vue.unref(o).state.label.equipmentName},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),Vue.createVNode(r,{prop:"specification",label:Vue.unref(o).state.label.specification},{default:Vue.withCtx(()=>[Vue.createVNode(d,{modelValue:Vue.unref(a).specification,"onUpdate:modelValue":t[8]||(t[8]=e=>Vue.unref(a).specification=e),placeholder:Vue.unref(o).state.label.specification},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),Vue.createVNode(r,{prop:"date",label:Vue.unref(o).state.label.date},{default:Vue.withCtx(()=>[Vue.createVNode(L,{type:"date",modelValue:Vue.unref(a).date,"onUpdate:modelValue":t[9]||(t[9]=e=>Vue.unref(a).date=e),format:"YYYY-MM-DD",onChange:t[10]||(t[10]=e=>Vue.unref(a).date=Vue.unref(h)(Vue.unref(a).date,"yyyy-MM-dd"))},null,8,["modelValue"])]),_:1},8,["label"]),Vue.createVNode(r,{prop:"useUserList",label:Vue.unref(o).state.label.useUser},{default:Vue.withCtx(()=>[Vue.createVNode(p,{modelValue:Vue.unref(a).useUserList,"onUpdate:modelValue":t[11]||(t[11]=e=>Vue.unref(a).useUserList=e),clearable:"",filterable:"",multiple:"",placeholder:"Please select"},{default:Vue.withCtx(()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(g.value,e=>(Vue.openBlock(),Vue.createBlock(m,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),Vue.createVNode(r,{prop:"remark",label:Vue.unref(o).state.label.description},{default:Vue.withCtx(()=>[Vue.createVNode(d,{type:"textarea",rows:4,modelValue:Vue.unref(a).remark,"onUpdate:modelValue":t[12]||(t[12]=e=>Vue.unref(a).remark=e)},null,8,["modelValue"])]),_:1},8,["label"]),Vue.createVNode(r,{prop:"detailDescribe",label:Vue.unref(o).state.label.equipmentDetailDescribe},{default:Vue.withCtx(()=>[Vue.createVNode(d,{type:"textarea",rows:4,modelValue:Vue.unref(a).detailDescribe,"onUpdate:modelValue":t[13]||(t[13]=e=>Vue.unref(a).detailDescribe=e)},null,8,["modelValue"])]),_:1},8,["label"]),Vue.createVNode(r,{prop:"gasolineType",label:Vue.unref(o).state.label.gasolineType},{default:Vue.withCtx(()=>[Vue.createVNode(d,{type:"textarea",rows:4,modelValue:Vue.unref(a).gasolineType,"onUpdate:modelValue":t[14]||(t[14]=e=>Vue.unref(a).gasolineType=e)},null,8,["modelValue"])]),_:1},8,["label"]),Vue.createVNode(r,{prop:"chargeUser",label:Vue.unref(o).state.label.chargeUser},{default:Vue.withCtx(()=>[Vue.createVNode(p,{modelValue:Vue.unref(a).chargeUserList,"onUpdate:modelValue":t[15]||(t[15]=e=>Vue.unref(a).chargeUserList=e),clearable:"",filterable:"",multiple:"",placeholder:"Please select"},{default:Vue.withCtx(()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(g.value,e=>(Vue.openBlock(),Vue.createBlock(m,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),Vue.createVNode(r,{prop:"position",label:Vue.unref(o).state.label.equipmentPosition},{default:Vue.withCtx(()=>[Vue.createVNode(p,{modelValue:Vue.unref(a).position,"onUpdate:modelValue":t[16]||(t[16]=e=>Vue.unref(a).position=e),clearable:"",filterable:"",placeholder:"Please select"},{default:Vue.withCtx(()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(y).equipmentPositionList,e=>(Vue.openBlock(),Vue.createBlock(m,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),Vue.createVNode(r,{prop:"photoList",label:`${Vue.unref(o).state.label.photo}(${(Vue.unref(V).photoList||[]).reduce((e,s)=>`Min: ${s.min}, Max: ${s.max}`,"Unlimited")})`},{default:Vue.withCtx(()=>[Vue.createVNode(le,{photoList:Vue.unref(a).photoList,maxSize:+`${(Vue.unref(V).photoList||[]).reduce((e,s)=>s.max,999)}`},null,8,["photoList","maxSize"])]),_:1},8,["label"]),Vue.createVNode(r,{prop:"fileList",label:`${Vue.unref(o).state.label.attachment}(${(Vue.unref(V).fileList||[]).reduce((e,s)=>`Min: ${s.min}, Max: ${s.max}`,"Unlimited")})`},{default:Vue.withCtx(()=>[Vue.createVNode(ae,{fileList:Vue.unref(a).fileList,maxSize:+`${(Vue.unref(V).fileList||[]).reduce((e,s)=>s.max,999)}`},null,8,["fileList","maxSize"])]),_:1},8,["label"])]),_:1},8,["rules","model"])]),_:1},8,["title","modelValue"])])}}});export{we as default};
