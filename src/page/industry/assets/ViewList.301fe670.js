import{V as k,a as F}from"./ViewContent.29936a75.js";import{_ as Z,t as J,u as Q}from"./main.e162c083.js";import{P as X}from"./Common.00b9c206.js";import{h as L}from"./IndustryUtil.35abe8a4.js";import Y from"./TableViewContent.c1fd5c92.js";import"./index.c3e79e11.js";import"./TableColumnViewContent.779ce4dc.js";const ee={key:0},te=Vue.createTextVNode("` "),le={style:{display:"flex","flex-direction":"column","align-items":"center","justify-content":"flex-start","margin-bottom":"20px",position:"absolute",width:"100%",top:"20px"},id:"printContainer"},ae={style:{display:"flex","flex-direction":"column","align-items":"center","justify-content":"center",width:"595px"}},ne={key:0},oe={key:1},ue={key:2,style:{display:"flex","justify-content":"flex-end",width:"100%"}},re=Vue.createTextVNode("` "),ie=Vue.defineComponent({__name:"ViewList",props:{idKey:{type:String,required:!0},columnConfigList:{type:Array,required:!0},list:{type:Array,required:!0},total:{type:Number,required:!1,default:-1},handleEdit:{type:Function,required:!1},handleUpdate:{type:Function,required:!1},handleEditShow:{type:Function,required:!1},handleDelete:{type:Function,required:!1},page:{type:Object,required:!1},handlePageChange:{type:Function,required:!1},handleLimitChange:{type:Function,required:!1},handleTableRowClassName:{type:Function,required:!1},detailLink:{type:Boolean,required:!1,default:!0}},emits:[],setup(q,{expose:z,emit:de}){const e=q;VueRouter.useRouter(),VueRouter.useRoute();const w=Vuex.useStore();w.state.roleCodeList;const N=`${e.idKey}_scale`,m={},u=Vue.ref(Number(J(N)||"1")),K=Math.max(window.innerHeight-380,550),R=Vue.ref(Math.max(2,1+Number((window.innerWidth/256).toFixed(0))));Vue.ref(Math.max(2,1+Number((window.innerWidth*.8/256).toFixed(0))));const V=Vue.ref(window.innerWidth>=512),b=Vue.ref(K/u.value),x=Vue.ref(!1),$=Vue.ref({}),P=()=>{b.value=K/u.value,Q(N,u.value)},A=()=>{document.body.style.height=I,x.value=!1},j=t=>{console.log(`e: ${t}`)},H=Vue.ref([]),h=Vue.ref(e.columnConfigList),c=Vue.ref(h.value.filter(t=>t.children&&t.children.length>0).map(t=>t.labelKey||t.label||"")),f=Vue.ref(c.value.map(t=>t)),C=Vue.ref(e.list);z({});const I=document.body.style.height,D=t=>{x.value=!0,$.value=t;const a=document.getElementsByClassName("view-list-print-drawer"),r=a[a.length-1];setTimeout(()=>{S(r,r,"el-descriptions")},500)},S=(t,a=t,r,n=!0)=>{const g=a.children||[];let o=null;for(let p=0;p<g.length;p++){const i=g[p];if((i.getAttribute("class")||"").indexOf(r)>=0?(o=i,console.log(`content height: ${o.offsetHeight}, r: ${o}`),t.style.height=o.offsetHeight+600+"px"):o=S(t,i,r,!1),o!==null)break}return!o&&n&&setTimeout(()=>{S(t,a,r)},100),o},M=()=>L(h.value,[k.Image,k.Video],!1,!0,c.value,f.value),T=()=>{for(let n in m)delete m[n];const t=M(),a=C.value,r=a.length;for(let n=0;n<r;n++){const g=a[n];for(let o=0;o<t.length;o++){const p=t[o];if(p.mergeKey){const i=o,y=p.mergeKey;if(!m[`${n}-${i}`]){let v=n;for(;++v<r;){const E=a[v];let _=!0;for(let l=0;l<y.length;l++){const s=y[l];if(g[s]!==E[s]){_=!1;break}}if(_)m[`${v}-${i}`]={rowspan:0,colspan:0};else break}m[`${n}-${i}`]={rowspan:v-n,colspan:1}}}}}},G=({row:t,column:a,rowIndex:r,columnIndex:n})=>m[`${r}-${n}`]||{rowspan:1,colspan:1},W=({row:t,rowIndex:a})=>t.valid?"row-done":"";return Vue.watch(()=>e.list,t=>{C.value=t,T()},{immediate:!0}),Vue.watch(()=>e.columnConfigList,t=>{h.value=t,T()},{immediate:!0}),(t,a)=>{const r=Vue.resolveComponent("el-switch"),n=Vue.resolveComponent("el-input-number"),g=Vue.resolveComponent("el-space"),o=Vue.resolveComponent("el-checkbox"),p=Vue.resolveComponent("el-checkbox-group"),i=Vue.resolveComponent("el-descriptions-item"),y=Vue.resolveComponent("el-descriptions"),v=Vue.resolveComponent("el-table"),E=Vue.resolveComponent("el-pagination"),_=Vue.resolveComponent("el-drawer");return Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,null,[Vue.createElementVNode("div",null,[Vue.createVNode(g,{wrap:""},{default:Vue.withCtx(()=>[Vue.createVNode(r,{modelValue:V.value,"onUpdate:modelValue":a[0]||(a[0]=l=>V.value=l),"active-text":"PC model","inactive-text":"Mobile model"},null,8,["modelValue"]),V.value?(Vue.openBlock(),Vue.createBlock(n,{key:0,modelValue:u.value,"onUpdate:modelValue":a[1]||(a[1]=l=>u.value=l),min:.2,max:1,step:.05,"step-strictly":"",style:{"margin-left":"20px"},onChange:P},null,8,["modelValue","min","step"])):Vue.createCommentVNode("v-if",!0)]),_:1})]),c.value&&c.value.length>0?(Vue.openBlock(),Vue.createElementBlock("div",ee,[Vue.createVNode(p,{modelValue:f.value,"onUpdate:modelValue":a[2]||(a[2]=l=>f.value=l),onChange:j},{default:Vue.withCtx(()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(c.value,(l,s)=>(Vue.openBlock(),Vue.createBlock(o,{key:l,label:l,value:l},{default:Vue.withCtx(()=>[Vue.createTextVNode(Vue.toDisplayString(Vue.unref(w).state.label[l]||l),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])])):Vue.createCommentVNode("v-if",!0),V.value?Vue.createCommentVNode("v-if",!0):(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,{key:1},Vue.renderList(C.value,(l,s)=>(Vue.openBlock(),Vue.createBlock(y,{key:"des-"+s,title:`Submit info ${s+1}`,direction:"vertical",column:R.value,style:{"margin-bottom":"20px"},border:""},{default:Vue.withCtx(()=>[te,(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(L)(h.value,[Vue.unref(k).Expand],!0,!1,c.value,f.value),(d,U)=>(Vue.openBlock(),Vue.createBlock(i,{key:d.value,label:d.labelKey?Vue.unref(w).state.label[d.labelKey]:d.label,align:d.align||"center"},{default:Vue.withCtx(()=>[Vue.createVNode(F,{idKey:e.idKey,viewConfig:d,row:l,handleShowDetail:e.detailLink?D:null,handleEdit:e.handleEdit,handleUpdate:e.handleUpdate,handleEditShow:e.handleEditShow,handleDelete:e.handleDelete},{expand:Vue.withCtx(B=>[Vue.renderSlot(t.$slots,"expand",{param:B.param})]),template:Vue.withCtx(({param:B,viewConfig:O})=>[Vue.renderSlot(t.$slots,"template",{param:B,viewConfig:O})]),_:2},1032,["idKey","viewConfig","row","handleShowDetail","handleEdit","handleUpdate","handleEditShow","handleDelete"])]),_:2},1032,["label","align"]))),128))]),_:2},1032,["title","column"]))),128)),V.value?(Vue.openBlock(),Vue.createBlock(v,{key:2,ref:"tableRef","header-cell-style":{background:" rgba(250, 251, 252, 1)",color:"rgba(102, 102, 102, 1)",height:"54px",fontSize:"14px",padding:0,boxShadow:"inset 0px -1px 0px  rgba(238, 238, 238, 1),inset 0px 1px 0px  rgba(238, 238, 238, 1)"},border:!0,data:C.value,size:"small","row-key":e.idKey,"expand-row-keys":H.value,height:b.value,"row-class-name":e.handleTableRowClassName||W,"span-method":G,style:Vue.normalizeStyle({transform:`scale(${u.value})`,width:`${100*(1/u.value)}% !important`,maxWidth:`${100*(1/u.value)}% !important`,marginLeft:`${100*(1/u.value-1)/-2}%`,marginTop:`${b.value*(1-u.value)/-2}px`,display:u.value===1?"":"block"})},{default:Vue.withCtx(()=>[Vue.createVNode(Y,{idKey:e.idKey,viewConfigList:h.value,handleShowDetail:e.detailLink?D:null,handleEdit:e.handleEdit,handleUpdate:e.handleUpdate,handleEditShow:e.handleEditShow,handleDelete:e.handleDelete,groupList:c.value,checkedGroupList:f.value,scale:u.value},{operator:Vue.withCtx(l=>[Vue.renderSlot(t.$slots,"operator",{param:l.param})]),template:Vue.withCtx(({param:l,viewConfig:s})=>[Vue.renderSlot(t.$slots,"template",{param:l,viewConfig:s})]),_:3},8,["idKey","viewConfigList","handleShowDetail","handleEdit","handleUpdate","handleEditShow","handleDelete","groupList","checkedGroupList","scale"])]),_:3},8,["header-cell-style","data","row-key","expand-row-keys","height","row-class-name","style"])):Vue.createCommentVNode("v-if",!0),e.total>=0?(Vue.openBlock(),Vue.createBlock(E,{key:3,background:"","page-sizes":Vue.unref(X),currentPage:e.page.page,"onUpdate:currentPage":a[3]||(a[3]=l=>e.page.page=l),"page-size":e.page.limit,total:e.total,onCurrentChange:e.handlePageChange,onSizeChange:e.handleLimitChange,layout:"total, sizes, prev, pager, next, jumper",style:Vue.normalizeStyle({marginTop:V.value?`${b.value*(1-u.value)/-2}px`:0})},null,8,["page-sizes","currentPage","page-size","total","onCurrentChange","onSizeChange","style"])):Vue.createCommentVNode("v-if",!0),e.detailLink?(Vue.openBlock(),Vue.createBlock(_,{key:4,modelValue:x.value,"onUpdate:modelValue":a[4]||(a[4]=l=>x.value=l),size:"100%","append-to-body":!0,"lock-scroll":!1,"modal-class":"view-list-print-drawer","before-close":A,"z-index":99999},{default:Vue.withCtx(()=>[Vue.createElementVNode("div",le,[Vue.createElementVNode("div",ae,[e.detailTitle?(Vue.openBlock(),Vue.createElementBlock("h1",ne,Vue.toDisplayString(e.detailTitle),1)):(Vue.openBlock(),Vue.createElementBlock("h1",oe,Vue.toDisplayString(Vue.unref(w).state.label[e.idKey.substring(0,e.idKey.length-2)]),1)),e.detailSubTitle?(Vue.openBlock(),Vue.createElementBlock("div",ue,[Vue.createElementVNode("h5",null,Vue.toDisplayString(e.detailSubTitle),1)])):Vue.createCommentVNode("v-if",!0),Vue.createCommentVNode('direction="vertical"'),Vue.createVNode(y,{column:1,style:{width:"100%"},border:""},{default:Vue.withCtx(()=>[re,(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(L)(h.value,[Vue.unref(k).Expand,Vue.unref(k).Operator],!0,!1,c.value,f.value),(l,s)=>(Vue.openBlock(),Vue.createBlock(i,{key:l.value,label:l.labelKey?Vue.unref(w).state.label[l.labelKey]:l.label,align:"center","label-class-name":"print-label"},{default:Vue.withCtx(()=>[Vue.createVNode(F,{idKey:e.idKey,viewConfig:l,row:$.value,handleEdit:e.handleEdit,handleUpdate:e.handleUpdate,handleEditShow:e.handleEditShow,handleDelete:e.handleDelete,fullMessage:!0},{expand:Vue.withCtx(d=>[Vue.renderSlot(t.$slots,"expand",{param:d.param})]),template:Vue.withCtx(({param:d,viewConfig:U})=>[Vue.renderSlot(t.$slots,"template",{param:d,viewConfig:U})]),_:2},1032,["idKey","viewConfig","row","handleEdit","handleUpdate","handleEditShow","handleDelete"])]),_:2},1032,["label"]))),128))]),_:3})])])]),_:3},8,["modelValue"])):Vue.createCommentVNode("v-if",!0)],64)}}});var ge=Z(ie,[["__file","D:/code/mp-server/src/page/src/page/industry/component/ViewList.vue"]]);export{ge as default};
